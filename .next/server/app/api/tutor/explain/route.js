"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tutor/explain/route";
exports.ids = ["app/api/tutor/explain/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:assert":
/*!******************************!*\
  !*** external "node:assert" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:assert");

/***/ }),

/***/ "node:async_hooks":
/*!***********************************!*\
  !*** external "node:async_hooks" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:async_hooks");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:buffer");

/***/ }),

/***/ "node:console":
/*!*******************************!*\
  !*** external "node:console" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("node:console");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:diagnostics_channel":
/*!*******************************************!*\
  !*** external "node:diagnostics_channel" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = require("node:diagnostics_channel");

/***/ }),

/***/ "node:dns":
/*!***************************!*\
  !*** external "node:dns" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:dns");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:events");

/***/ }),

/***/ "node:http":
/*!****************************!*\
  !*** external "node:http" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:http");

/***/ }),

/***/ "node:http2":
/*!*****************************!*\
  !*** external "node:http2" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("node:http2");

/***/ }),

/***/ "node:net":
/*!***************************!*\
  !*** external "node:net" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:net");

/***/ }),

/***/ "node:perf_hooks":
/*!**********************************!*\
  !*** external "node:perf_hooks" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:perf_hooks");

/***/ }),

/***/ "node:querystring":
/*!***********************************!*\
  !*** external "node:querystring" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:querystring");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:tls":
/*!***************************!*\
  !*** external "node:tls" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:tls");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:url");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:util");

/***/ }),

/***/ "node:util/types":
/*!**********************************!*\
  !*** external "node:util/types" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:util/types");

/***/ }),

/***/ "node:worker_threads":
/*!**************************************!*\
  !*** external "node:worker_threads" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("node:worker_threads");

/***/ }),

/***/ "node:zlib":
/*!****************************!*\
  !*** external "node:zlib" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftutor%2Fexplain%2Froute&page=%2Fapi%2Ftutor%2Fexplain%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftutor%2Fexplain%2Froute.ts&appDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot&isDev=true&tsconfigPath=.%2Ftsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftutor%2Fexplain%2Froute&page=%2Fapi%2Ftutor%2Fexplain%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftutor%2Fexplain%2Froute.ts&appDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot&isDev=true&tsconfigPath=.%2Ftsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_Code_projects_github_projects_smart_sage_bot_app_api_tutor_explain_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/tutor/explain/route.ts */ \"(rsc)/./app/api/tutor/explain/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tutor/explain/route\",\n        pathname: \"/api/tutor/explain\",\n        filename: \"route\",\n        bundlePath: \"app/api/tutor/explain/route\"\n    },\n    resolvedPagePath: \"E:\\\\Code projects\\\\github projects\\\\smart-sage-bot\\\\app\\\\api\\\\tutor\\\\explain\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_Code_projects_github_projects_smart_sage_bot_app_api_tutor_explain_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/tutor/explain/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0dXRvciUyRmV4cGxhaW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnR1dG9yJTJGZXhwbGFpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnR1dG9yJTJGZXhwbGFpbiUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDQ29kZSUyMHByb2plY3RzJTVDZ2l0aHViJTIwcHJvamVjdHMlNUNzbWFydC1zYWdlLWJvdCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RSUzQSU1Q0NvZGUlMjBwcm9qZWN0cyU1Q2dpdGh1YiUyMHByb2plY3RzJTVDc21hcnQtc2FnZS1ib3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9LiUyRnRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNzQztBQUNuSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NtYXJ0LXNhZ2UtYm90Lz85M2IwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkU6XFxcXENvZGUgcHJvamVjdHNcXFxcZ2l0aHViIHByb2plY3RzXFxcXHNtYXJ0LXNhZ2UtYm90XFxcXGFwcFxcXFxhcGlcXFxcdHV0b3JcXFxcZXhwbGFpblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdHV0b3IvZXhwbGFpbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3R1dG9yL2V4cGxhaW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3R1dG9yL2V4cGxhaW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJFOlxcXFxDb2RlIHByb2plY3RzXFxcXGdpdGh1YiBwcm9qZWN0c1xcXFxzbWFydC1zYWdlLWJvdFxcXFxhcHBcXFxcYXBpXFxcXHR1dG9yXFxcXGV4cGxhaW5cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3R1dG9yL2V4cGxhaW4vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftutor%2Fexplain%2Froute&page=%2Fapi%2Ftutor%2Fexplain%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftutor%2Fexplain%2Froute.ts&appDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot&isDev=true&tsconfigPath=.%2Ftsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/tutor/explain/route.ts":
/*!****************************************!*\
  !*** ./app/api/tutor/explain/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _server_pipelines__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/server/pipelines */ \"(rsc)/./src/server/pipelines.ts\");\n\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { message, topic, userLevel = \"intermediate\", learningStyle = \"reading\" } = body || {};\n        if (!message || typeof message !== \"string\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Message is required and must be a string\"\n            }, {\n                status: 400\n            });\n        }\n        const pipeline = (0,_server_pipelines__WEBPACK_IMPORTED_MODULE_1__.createPipeline)(\"tutor\");\n        const result = await pipeline.process(message, {\n            topic: topic || message,\n            userLevel,\n            learningStyle,\n            documentCount: 8\n        });\n        const response = {\n            success: true,\n            tutorialSections: result.tutorialSections || [],\n            thinkingSteps: result.thinkingSteps,\n            pipelineInfo: result.pipelineInfo,\n            sources: result.sources || [],\n            mode: \"tutor\",\n            metadata: result.metadata || {\n                topic: topic || message,\n                userLevel,\n                learningStyle,\n                sectionCount: result.tutorialSections?.length || 0\n            },\n            timestamp: new Date().toISOString()\n        };\n        if (!result.tutorialSections || result.tutorialSections.length === 0) {\n            response.error = result.error || \"Unable to generate tutorial content for this topic.\";\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error?.message || \"Unknown error\",\n            tutorialSections: [],\n            timestamp: new Date().toISOString()\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3R1dG9yL2V4cGxhaW4vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTBDO0FBQ1M7QUFFNUMsZUFBZUUsS0FBS0MsT0FBZ0I7SUFDekMsSUFBSTtRQUNGLE1BQU1DLE9BQU8sTUFBTUQsUUFBUUUsSUFBSTtRQUMvQixNQUFNLEVBQUVDLE9BQU8sRUFBRUMsS0FBSyxFQUFFQyxZQUFZLGNBQWMsRUFBRUMsZ0JBQWdCLFNBQVMsRUFBRSxHQUFHTCxRQUFRLENBQUM7UUFDM0YsSUFBSSxDQUFDRSxXQUFXLE9BQU9BLFlBQVksVUFBVTtZQUMzQyxPQUFPTixxREFBWUEsQ0FBQ0ssSUFBSSxDQUFDO2dCQUFFSyxTQUFTO2dCQUFPQyxPQUFPO1lBQTJDLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNoSDtRQUNBLE1BQU1DLFdBQVdaLGlFQUFjQSxDQUFDO1FBQ2hDLE1BQU1hLFNBQVMsTUFBTUQsU0FBU0UsT0FBTyxDQUFDVCxTQUFTO1lBQUVDLE9BQU9BLFNBQVNEO1lBQVNFO1lBQVdDO1lBQWVPLGVBQWU7UUFBRTtRQUNySCxNQUFNQyxXQUFnQjtZQUNwQlAsU0FBUztZQUNUUSxrQkFBa0JKLE9BQU9JLGdCQUFnQixJQUFJLEVBQUU7WUFDL0NDLGVBQWVMLE9BQU9LLGFBQWE7WUFDbkNDLGNBQWNOLE9BQU9NLFlBQVk7WUFDakNDLFNBQVNQLE9BQU9PLE9BQU8sSUFBSSxFQUFFO1lBQzdCQyxNQUFNO1lBQ05DLFVBQVVULE9BQU9TLFFBQVEsSUFBSTtnQkFBRWhCLE9BQU9BLFNBQVNEO2dCQUFTRTtnQkFBV0M7Z0JBQWVlLGNBQWNWLE9BQU9JLGdCQUFnQixFQUFFTyxVQUFVO1lBQUU7WUFDcklDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztRQUNuQztRQUNBLElBQUksQ0FBQ2QsT0FBT0ksZ0JBQWdCLElBQUlKLE9BQU9JLGdCQUFnQixDQUFDTyxNQUFNLEtBQUssR0FBRztZQUNwRVIsU0FBU04sS0FBSyxHQUFHRyxPQUFPSCxLQUFLLElBQUk7UUFDbkM7UUFDQSxPQUFPWCxxREFBWUEsQ0FBQ0ssSUFBSSxDQUFDWTtJQUMzQixFQUFFLE9BQU9OLE9BQVk7UUFDbkIsT0FBT1gscURBQVlBLENBQUNLLElBQUksQ0FBQztZQUFFSyxTQUFTO1lBQU9DLE9BQU9BLE9BQU9MLFdBQVc7WUFBaUJZLGtCQUFrQixFQUFFO1lBQUVRLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztRQUFHLEdBQUc7WUFBRWhCLFFBQVE7UUFBSTtJQUNsSztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnQtc2FnZS1ib3QvLi9hcHAvYXBpL3R1dG9yL2V4cGxhaW4vcm91dGUudHM/YmUyNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgY3JlYXRlUGlwZWxpbmUgfSBmcm9tICdAL3NlcnZlci9waXBlbGluZXMnXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgY29uc3QgeyBtZXNzYWdlLCB0b3BpYywgdXNlckxldmVsID0gJ2ludGVybWVkaWF0ZScsIGxlYXJuaW5nU3R5bGUgPSAncmVhZGluZycgfSA9IGJvZHkgfHwge31cclxuICAgIGlmICghbWVzc2FnZSB8fCB0eXBlb2YgbWVzc2FnZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTWVzc2FnZSBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIHN0cmluZycgfSwgeyBzdGF0dXM6IDQwMCB9KVxyXG4gICAgfVxyXG4gICAgY29uc3QgcGlwZWxpbmUgPSBjcmVhdGVQaXBlbGluZSgndHV0b3InKVxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGlwZWxpbmUucHJvY2VzcyhtZXNzYWdlLCB7IHRvcGljOiB0b3BpYyB8fCBtZXNzYWdlLCB1c2VyTGV2ZWwsIGxlYXJuaW5nU3R5bGUsIGRvY3VtZW50Q291bnQ6IDggfSlcclxuICAgIGNvbnN0IHJlc3BvbnNlOiBhbnkgPSB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIHR1dG9yaWFsU2VjdGlvbnM6IHJlc3VsdC50dXRvcmlhbFNlY3Rpb25zIHx8IFtdLFxyXG4gICAgICB0aGlua2luZ1N0ZXBzOiByZXN1bHQudGhpbmtpbmdTdGVwcyxcclxuICAgICAgcGlwZWxpbmVJbmZvOiByZXN1bHQucGlwZWxpbmVJbmZvLFxyXG4gICAgICBzb3VyY2VzOiByZXN1bHQuc291cmNlcyB8fCBbXSxcclxuICAgICAgbW9kZTogJ3R1dG9yJyxcclxuICAgICAgbWV0YWRhdGE6IHJlc3VsdC5tZXRhZGF0YSB8fCB7IHRvcGljOiB0b3BpYyB8fCBtZXNzYWdlLCB1c2VyTGV2ZWwsIGxlYXJuaW5nU3R5bGUsIHNlY3Rpb25Db3VudDogcmVzdWx0LnR1dG9yaWFsU2VjdGlvbnM/Lmxlbmd0aCB8fCAwIH0sXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfVxyXG4gICAgaWYgKCFyZXN1bHQudHV0b3JpYWxTZWN0aW9ucyB8fCByZXN1bHQudHV0b3JpYWxTZWN0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmVzcG9uc2UuZXJyb3IgPSByZXN1bHQuZXJyb3IgfHwgJ1VuYWJsZSB0byBnZW5lcmF0ZSB0dXRvcmlhbCBjb250ZW50IGZvciB0aGlzIHRvcGljLidcclxuICAgIH1cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSlcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yPy5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJywgdHV0b3JpYWxTZWN0aW9uczogW10sIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0sIHsgc3RhdHVzOiA1MDAgfSlcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZVBpcGVsaW5lIiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsIm1lc3NhZ2UiLCJ0b3BpYyIsInVzZXJMZXZlbCIsImxlYXJuaW5nU3R5bGUiLCJzdWNjZXNzIiwiZXJyb3IiLCJzdGF0dXMiLCJwaXBlbGluZSIsInJlc3VsdCIsInByb2Nlc3MiLCJkb2N1bWVudENvdW50IiwicmVzcG9uc2UiLCJ0dXRvcmlhbFNlY3Rpb25zIiwidGhpbmtpbmdTdGVwcyIsInBpcGVsaW5lSW5mbyIsInNvdXJjZXMiLCJtb2RlIiwibWV0YWRhdGEiLCJzZWN0aW9uQ291bnQiLCJsZW5ndGgiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/tutor/explain/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/agents.ts":
/*!******************************!*\
  !*** ./src/server/agents.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AnswerAgent: () => (/* binding */ AnswerAgent),\n/* harmony export */   BaseAgent: () => (/* binding */ BaseAgent),\n/* harmony export */   CriticAgent: () => (/* binding */ CriticAgent),\n/* harmony export */   QueryAgent: () => (/* binding */ QueryAgent),\n/* harmony export */   QuizAgent: () => (/* binding */ QuizAgent),\n/* harmony export */   RefineAgent: () => (/* binding */ RefineAgent),\n/* harmony export */   RetrievalAgent: () => (/* binding */ RetrievalAgent),\n/* harmony export */   TutorAgent: () => (/* binding */ TutorAgent)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var _vectorstore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./vectorstore */ \"(rsc)/./src/server/vectorstore.ts\");\n\n\n\nconst GOOGLE_API_KEY = process.env.GOOGLE_API_KEY;\nconst OLLAMA_HOST = process.env.OLLAMA_HOST || \"http://localhost:11434\";\nconst GEMINI_MODEL = process.env.GEMINI_MODEL || \"gemini-1.5-flash\";\nconst GEMINI_TEMPERATURE = parseFloat(process.env.GEMINI_TEMPERATURE || \"0.7\");\nconst GEMINI_MAX_TOKENS = parseInt(process.env.GEMINI_MAX_TOKENS || \"2048\");\nconst genAI = GOOGLE_API_KEY ? new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(GOOGLE_API_KEY) : null;\nclass BaseAgent {\n    constructor(name){\n        this.name = name;\n    }\n    async process(_input) {\n        throw new Error(\"not implemented\");\n    }\n}\nclass QueryAgent extends BaseAgent {\n    constructor(){\n        super(\"QueryAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        const processedQuery = String(input.query || \"\").trim();\n        const needsRetrieval = this.shouldRetrieve(processedQuery);\n        steps.push({\n            agent: this.name,\n            step: \"Query Analysis\",\n            status: \"completed\",\n            message: `Query processed. Needs retrieval: ${needsRetrieval}`,\n            details: {\n                originalQuery: input.query,\n                processedQuery,\n                needsRetrieval\n            }\n        });\n        return {\n            processedQuery,\n            needsRetrieval,\n            thinkingSteps: steps\n        };\n    }\n    shouldRetrieve(q) {\n        const words = [\n            \"what\",\n            \"how\",\n            \"why\",\n            \"when\",\n            \"where\",\n            \"who\",\n            \"which\"\n        ];\n        const l = q.toLowerCase();\n        return words.some((w)=>l.includes(w)) || q.length > 20 || l.includes(\"?\");\n    }\n}\nclass RetrievalAgent extends BaseAgent {\n    constructor(){\n        super(\"RetrievalAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        steps.push({\n            agent: this.name,\n            step: \"Vector Search\",\n            status: \"processing\",\n            message: \"Searching for relevant documents...\"\n        });\n        try {\n            const store = await (0,_vectorstore__WEBPACK_IMPORTED_MODULE_1__.getVectorStore)();\n            console.log(`[RetrievalAgent] Searching for query: \"${input.query}\" with k=${input.k || 5}`);\n            const documents = await store.similaritySearch(input.query, input.k || 5);\n            console.log(`[RetrievalAgent] Search returned ${documents.length} documents`);\n            if (documents.length === 0) {\n                console.log(\"[RetrievalAgent] NO SOURCES - No documents found in collection\");\n            } else {\n                console.log(\"[RetrievalAgent] Documents found:\", documents.map((d)=>({\n                        contentPreview: d.content?.substring(0, 100) + \"...\",\n                        source: d.metadata?.source\n                    })));\n            }\n            steps.push({\n                agent: this.name,\n                step: \"Vector Search\",\n                status: \"completed\",\n                message: `Found ${documents.length} relevant documents`\n            });\n            return {\n                documents,\n                thinkingSteps: steps\n            };\n        } catch (error) {\n            console.error(\"[RetrievalAgent] Error during search:\", error);\n            steps.push({\n                agent: this.name,\n                step: \"Vector Search\",\n                status: \"error\",\n                message: `Search failed: ${error.message}`\n            });\n            return {\n                documents: [],\n                thinkingSteps: steps\n            };\n        }\n    }\n}\nclass AnswerAgent extends BaseAgent {\n    constructor(){\n        super(\"AnswerAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        steps.push({\n            agent: this.name,\n            step: \"Response Generation\",\n            status: \"processing\",\n            message: \"Generating response using retrieved context...\"\n        });\n        const context = (input.documents || []).map((d)=>d.content).join(\"\\n\\n\");\n        const answer = await this.generateAnswer(input.query, context);\n        steps.push({\n            agent: this.name,\n            step: \"Response Generation\",\n            status: \"completed\",\n            message: \"Response generated successfully\"\n        });\n        return {\n            answer,\n            thinkingSteps: steps\n        };\n    }\n    async generateAnswer(query, context) {\n        const prompt = `Based on the following context, please answer the question. If the context doesn't contain enough information to answer the question, please say so.\r\n\r\nContext:\r\n${context}\r\n\r\nQuestion: ${query}\r\n\r\nAnswer:`;\n        if (genAI) {\n            try {\n                const model = genAI.getGenerativeModel({\n                    model: GEMINI_MODEL,\n                    generationConfig: {\n                        temperature: GEMINI_TEMPERATURE,\n                        maxOutputTokens: GEMINI_MAX_TOKENS\n                    }\n                });\n                const result = await model.generateContent(prompt);\n                const response = await result.response;\n                return response.text();\n            } catch (e) {\n                console.warn(\"Google Gemini failed:\", e);\n            }\n        }\n        try {\n            const response = await axios__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(`${OLLAMA_HOST}/api/generate`, {\n                model: \"gemma3:1b\",\n                prompt,\n                stream: false\n            });\n            return response.data.response;\n        } catch (e) {\n            console.error(\"Ollama failed:\", e);\n        }\n        return \"I apologize, but I'm unable to generate a response at the moment. Please try again later.\";\n    }\n}\nclass CriticAgent extends BaseAgent {\n    constructor(){\n        super(\"CriticAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        const critiques = [];\n        let score = 5;\n        if ((input.answer || \"\").length < 50) critiques.push(\"Answer is too brief\");\n        if ((input.answer || \"\").includes(\"I don't know\") || (input.answer || \"\").includes(\"I can't\")) critiques.push(\"Answer indicates uncertainty\");\n        if ((input.documents || []).length === 0) critiques.push(\"No supporting documents found\");\n        if ((input.answer || \"\").length > 100) score += 1;\n        if ((input.documents || []).length > 0) score += 2;\n        if (!(input.answer || \"\").includes(\"I don't know\")) score += 1;\n        steps.push({\n            agent: this.name,\n            step: \"Answer Evaluation\",\n            status: \"completed\",\n            message: `Answer evaluated with score: ${score}/10`,\n            details: {\n                critique: critiques.length ? critiques.join(\"; \") : \"Answer appears comprehensive and well-supported\",\n                score\n            }\n        });\n        return {\n            critique: critiques.length ? critiques.join(\"; \") : \"Answer appears comprehensive and well-supported\",\n            score,\n            thinkingSteps: steps\n        };\n    }\n}\nclass RefineAgent extends BaseAgent {\n    constructor(){\n        super(\"RefineAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        const refinementPrompt = `Please refine the following answer based on the critique provided. Make it more comprehensive and accurate.\r\n\r\nOriginal Query: ${input.query}\r\nOriginal Answer: ${input.answer}\r\nCritique: ${input.critique}\r\nSupporting Documents: ${(input.documents || []).map((d)=>d.content).join(\"\\n\\n\")}\r\n\r\nRefined Answer:`;\n        let refined = input.answer;\n        if (genAI) {\n            try {\n                const model = genAI.getGenerativeModel({\n                    model: GEMINI_MODEL,\n                    generationConfig: {\n                        temperature: GEMINI_TEMPERATURE,\n                        maxOutputTokens: GEMINI_MAX_TOKENS\n                    }\n                });\n                const result = await model.generateContent(refinementPrompt);\n                const response = await result.response;\n                refined = response.text();\n            } catch (e) {\n                console.warn(\"Google Gemini failed for refinement:\", e);\n            }\n        } else {\n            try {\n                const response = await axios__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(`${OLLAMA_HOST}/api/generate`, {\n                    model: \"gemma3:1b\",\n                    prompt: refinementPrompt,\n                    stream: false\n                });\n                refined = response.data.response;\n            } catch (e) {\n                console.error(\"Ollama failed for refinement:\", e);\n            }\n        }\n        steps.push({\n            agent: this.name,\n            step: \"Answer Refinement\",\n            status: \"completed\",\n            message: \"Answer refined successfully\"\n        });\n        return {\n            refinedAnswer: refined,\n            thinkingSteps: steps\n        };\n    }\n}\nclass QuizAgent extends BaseAgent {\n    constructor(){\n        super(\"QuizAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        const context = (input.documents || []).map((d)=>d.content).join(\"\\n\\n\");\n        const prompt = `Based on the following context about \"${input.topic}\", generate ${input.questionCount || 3} multiple choice questions with difficulty level: ${input.difficulty || \"medium\"}.\r\n\r\nFor each question, provide:\r\n1. A clear question\r\n2. 4 multiple choice options (A, B, C, D)\r\n3. The correct answer (A, B, C, or D)\r\n4. A brief explanation of why the answer is correct\r\n\r\nFormat as JSON array with this structure:\r\n[\r\n  {\r\n    \"question\": \"Question text here?\",\r\n    \"options\": [\"Option A\", \"Option B\", \"Option C\", \"Option D\"],\r\n    \"correctAnswer\": 1,\r\n    \"explanation\": \"Explanation here\",\r\n    \"difficulty\": \"${input.difficulty || \"medium\"}\",\r\n    \"category\": \"${input.topic}\"\r\n  }\r\n]\r\n\r\nContext:\r\n${context}\r\n\r\nJSON Response:`;\n        if (genAI) {\n            try {\n                const model = genAI.getGenerativeModel({\n                    model: GEMINI_MODEL,\n                    generationConfig: {\n                        temperature: 0.5,\n                        maxOutputTokens: GEMINI_MAX_TOKENS\n                    }\n                });\n                const result = await model.generateContent(prompt);\n                const text = (await result.response).text();\n                const m = text.match(/\\[[\\s\\S]*\\]/);\n                if (m) {\n                    const questions = JSON.parse(m[0]).map((q, idx)=>({\n                            id: `quiz_${Date.now()}_${idx}`,\n                            ...q,\n                            source: input.documents?.[0]?.metadata?.source || \"Generated from context\"\n                        }));\n                    steps.push({\n                        agent: this.name,\n                        step: \"Quiz Generation\",\n                        status: \"completed\",\n                        message: `Generated ${questions.length} quiz questions`\n                    });\n                    return {\n                        questions,\n                        thinkingSteps: steps\n                    };\n                }\n            } catch (e) {\n                console.warn(\"Quiz generation with Gemini failed:\", e);\n            }\n        } // fallback\n        const fallback = Array.from({\n            length: input.questionCount || 3\n        }).map((_, i)=>({\n                id: `fallback_${Date.now()}_${i}`,\n                question: `What is an important concept related to ${input.topic}?`,\n                options: [\n                    \"This is a concept from the provided context\",\n                    \"This is not relevant to the topic\",\n                    \"This is incorrect information\",\n                    \"This is not mentioned in the context\"\n                ],\n                correctAnswer: 0,\n                explanation: `Based on the provided context about ${input.topic}, the first option represents concepts discussed in the source material.`,\n                difficulty: input.difficulty || \"medium\",\n                category: input.topic,\n                source: input.documents?.[0]?.metadata?.source || \"Generated content\"\n            }));\n        steps.push({\n            agent: this.name,\n            step: \"Quiz Generation\",\n            status: \"completed\",\n            message: `Generated ${fallback.length} fallback quiz questions`\n        });\n        return {\n            questions: fallback,\n            thinkingSteps: steps\n        };\n    }\n}\nclass TutorAgent extends BaseAgent {\n    constructor(){\n        super(\"TutorAgent\");\n    }\n    async process(input) {\n        const steps = [];\n        const docs = input.documents || [];\n        steps.push({\n            agent: this.name,\n            step: \"Tutor Planning\",\n            status: \"processing\",\n            message: `Creating a structured tutorial for: ${input.topic}`\n        });\n        const context = docs.map((d)=>`- ${d.content}`).join(\"\\n\");\n        const jsonSpec = `Return JSON array with objects: { id: string, title: string, content: string, type: 'explanation' | 'example' | 'exercise' | 'summary' }`;\n        const prompt = `You are a patient, expert tutor. Create a short tutorial about \"${input.topic}\" using the context below. The tutorial should include 3-5 sections (mix of explanation, example, exercise, and a brief summary). Keep content concise but meaningful.\r\n\r\nContext (may be empty):\\n${context}\\n\\n${jsonSpec}\\nOnly output valid JSON array, nothing else.`;\n        try {\n            if (genAI) {\n                const model = genAI.getGenerativeModel({\n                    model: GEMINI_MODEL,\n                    generationConfig: {\n                        temperature: 0.6,\n                        maxOutputTokens: GEMINI_MAX_TOKENS\n                    }\n                });\n                const result = await model.generateContent(prompt);\n                const text = (await result.response).text();\n                const match = text.match(/\\[[\\s\\S]*\\]/);\n                if (match) {\n                    const sections = JSON.parse(match[0]);\n                    steps.push({\n                        agent: this.name,\n                        step: \"Tutor Generation\",\n                        status: \"completed\",\n                        message: `Generated ${sections.length} tutorial sections via LLM`\n                    });\n                    return {\n                        tutorialSections: sections,\n                        thinkingSteps: steps\n                    };\n                }\n            } else {\n                // Try Ollama as fallback\n                try {\n                    const response = await axios__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(`${OLLAMA_HOST}/api/generate`, {\n                        model: \"gemma3:1b\",\n                        prompt: `${prompt}\\n`,\n                        stream: false\n                    });\n                    const text = response.data.response;\n                    const match = text.match(/\\[[\\s\\S]*\\]/);\n                    if (match) {\n                        const sections = JSON.parse(match[0]);\n                        steps.push({\n                            agent: this.name,\n                            step: \"Tutor Generation\",\n                            status: \"completed\",\n                            message: `Generated ${sections.length} tutorial sections via Ollama`\n                        });\n                        return {\n                            tutorialSections: sections,\n                            thinkingSteps: steps\n                        };\n                    }\n                } catch (e) {}\n            }\n        } catch (e) {\n            console.warn(\"Tutor generation failed, using fallback:\", e);\n        }\n        // Static fallback\n        const sections = [\n            {\n                id: \"intro\",\n                title: `Overview of ${input.topic}`,\n                content: `This section introduces ${input.topic} with key ideas based on retrieved sources.`,\n                type: \"explanation\",\n                sources: docs\n            },\n            {\n                id: \"example\",\n                title: \"Worked example\",\n                content: \"A small example illustrating the concept.\",\n                type: \"example\",\n                sources: docs.slice(0, 1)\n            },\n            {\n                id: \"practice\",\n                title: \"Practice exercise\",\n                content: \"Try to summarize the concept in your own words.\",\n                type: \"exercise\",\n                sources: []\n            },\n            {\n                id: \"summary\",\n                title: \"Summary\",\n                content: `Key takeaways about ${input.topic}.`,\n                type: \"summary\",\n                sources: []\n            }\n        ];\n        steps.push({\n            agent: this.name,\n            step: \"Tutor Generation\",\n            status: \"completed\",\n            message: `Generated ${sections.length} fallback tutorial sections`\n        });\n        return {\n            tutorialSections: sections,\n            thinkingSteps: steps\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFDO2dCQUFFbEMsU0FBUyxDQUFDLHdCQUF3QixFQUFFbEMsTUFBTW9FLEtBQUssQ0FBQywyQ0FBMkMsQ0FBQztnQkFBRTRCLE1BQU07Z0JBQWVDLFNBQVNOO1lBQUs7WUFBRztnQkFBRWQsSUFBSTtnQkFBV2tCLE9BQU87Z0JBQWtCN0QsU0FBUztnQkFBNkM4RCxNQUFNO2dCQUFXQyxTQUFTTixLQUFLTyxLQUFLLENBQUMsR0FBRTtZQUFHO1lBQUc7Z0JBQUVyQixJQUFJO2dCQUFZa0IsT0FBTztnQkFBcUI3RCxTQUFTO2dCQUFtRDhELE1BQU07Z0JBQVlDLFNBQVMsRUFBRTtZQUFDO1lBQUc7Z0JBQUVwQixJQUFHO2dCQUFXa0IsT0FBTTtnQkFBVzdELFNBQVEsQ0FBQyxvQkFBb0IsRUFBRWxDLE1BQU1vRSxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUFFNEIsTUFBSztnQkFBV0MsU0FBUyxFQUFFO1lBQUM7U0FBRztRQUFXaEcsTUFBTU8sSUFBSSxDQUFDO1lBQUNDLE9BQU0sSUFBSSxDQUFDYixJQUFJO1lBQUNjLE1BQUs7WUFBbUJDLFFBQU87WUFBWUMsU0FBUSxDQUFDLFVBQVUsRUFBRWlGLFNBQVN0RSxNQUFNLENBQUMsMkJBQTJCLENBQUM7UUFBQTtRQUFJLE9BQU87WUFBRXVFLGtCQUFrQkQ7WUFBVTlFLGVBQWVkO1FBQU07SUFBRTtBQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnQtc2FnZS1ib3QvLi9zcmMvc2VydmVyL2FnZW50cy50cz84OTMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gXCJAZ29vZ2xlL2dlbmVyYXRpdmUtYWlcIlxyXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXHJcbmltcG9ydCB7IGdldFZlY3RvclN0b3JlIH0gZnJvbSAnLi92ZWN0b3JzdG9yZSdcclxuXHJcbmNvbnN0IEdPT0dMRV9BUElfS0VZID0gcHJvY2Vzcy5lbnYuR09PR0xFX0FQSV9LRVlcclxuY29uc3QgT0xMQU1BX0hPU1QgPSBwcm9jZXNzLmVudi5PTExBTUFfSE9TVCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCdcclxuY29uc3QgR0VNSU5JX01PREVMID0gcHJvY2Vzcy5lbnYuR0VNSU5JX01PREVMIHx8ICdnZW1pbmktMS41LWZsYXNoJ1xyXG5jb25zdCBHRU1JTklfVEVNUEVSQVRVUkUgPSBwYXJzZUZsb2F0KHByb2Nlc3MuZW52LkdFTUlOSV9URU1QRVJBVFVSRSB8fCAnMC43JylcclxuY29uc3QgR0VNSU5JX01BWF9UT0tFTlMgPSBwYXJzZUludChwcm9jZXNzLmVudi5HRU1JTklfTUFYX1RPS0VOUyB8fCAnMjA0OCcpXHJcblxyXG5jb25zdCBnZW5BSSA9IEdPT0dMRV9BUElfS0VZID8gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSShHT09HTEVfQVBJX0tFWSkgOiBudWxsXHJcblxyXG5leHBvcnQgY2xhc3MgQmFzZUFnZW50IHsgY29uc3RydWN0b3IocHVibGljIG5hbWU6IHN0cmluZykge30gYXN5bmMgcHJvY2VzcyhfaW5wdXQ6IGFueSk6IFByb21pc2U8YW55PiB7IHRocm93IG5ldyBFcnJvcignbm90IGltcGxlbWVudGVkJykgfSB9XHJcblxyXG5leHBvcnQgY2xhc3MgUXVlcnlBZ2VudCBleHRlbmRzIEJhc2VBZ2VudCB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ1F1ZXJ5QWdlbnQnKX0gYXN5bmMgcHJvY2VzcyhpbnB1dDogYW55KXsgY29uc3Qgc3RlcHM6YW55PVtdOyBjb25zdCBwcm9jZXNzZWRRdWVyeSA9IFN0cmluZyhpbnB1dC5xdWVyeXx8JycpLnRyaW0oKTsgY29uc3QgbmVlZHNSZXRyaWV2YWwgPSB0aGlzLnNob3VsZFJldHJpZXZlKHByb2Nlc3NlZFF1ZXJ5KTsgc3RlcHMucHVzaCh7YWdlbnQ6dGhpcy5uYW1lLHN0ZXA6J1F1ZXJ5IEFuYWx5c2lzJyxzdGF0dXM6J2NvbXBsZXRlZCcsbWVzc2FnZTpgUXVlcnkgcHJvY2Vzc2VkLiBOZWVkcyByZXRyaWV2YWw6ICR7bmVlZHNSZXRyaWV2YWx9YCxkZXRhaWxzOntvcmlnaW5hbFF1ZXJ5OmlucHV0LnF1ZXJ5LHByb2Nlc3NlZFF1ZXJ5LG5lZWRzUmV0cmlldmFsfX0pOyByZXR1cm4geyBwcm9jZXNzZWRRdWVyeSwgbmVlZHNSZXRyaWV2YWwsIHRoaW5raW5nU3RlcHM6IHN0ZXBzIH0gfSBzaG91bGRSZXRyaWV2ZShxOnN0cmluZyl7IGNvbnN0IHdvcmRzPVsnd2hhdCcsJ2hvdycsJ3doeScsJ3doZW4nLCd3aGVyZScsJ3dobycsJ3doaWNoJ107IGNvbnN0IGw9cS50b0xvd2VyQ2FzZSgpOyByZXR1cm4gd29yZHMuc29tZSh3PT5sLmluY2x1ZGVzKHcpKSB8fCBxLmxlbmd0aD4yMCB8fCBsLmluY2x1ZGVzKCc/JykgfSB9XHJcblxyXG5leHBvcnQgY2xhc3MgUmV0cmlldmFsQWdlbnQgZXh0ZW5kcyBCYXNlQWdlbnQgeyBcclxuICBjb25zdHJ1Y3Rvcigpe3N1cGVyKCdSZXRyaWV2YWxBZ2VudCcpfSBcclxuICBhc3luYyBwcm9jZXNzKGlucHV0OmFueSl7IFxyXG4gICAgY29uc3Qgc3RlcHM6YW55PVtdOyBcclxuICAgIHN0ZXBzLnB1c2goe2FnZW50OnRoaXMubmFtZSxzdGVwOidWZWN0b3IgU2VhcmNoJyxzdGF0dXM6J3Byb2Nlc3NpbmcnLG1lc3NhZ2U6J1NlYXJjaGluZyBmb3IgcmVsZXZhbnQgZG9jdW1lbnRzLi4uJ30pOyBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JlOmFueSA9IGF3YWl0IGdldFZlY3RvclN0b3JlKCk7IFxyXG4gICAgICBjb25zb2xlLmxvZyhgW1JldHJpZXZhbEFnZW50XSBTZWFyY2hpbmcgZm9yIHF1ZXJ5OiBcIiR7aW5wdXQucXVlcnl9XCIgd2l0aCBrPSR7aW5wdXQua3x8NX1gKTtcclxuICAgICAgY29uc3QgZG9jdW1lbnRzID0gYXdhaXQgc3RvcmUuc2ltaWxhcml0eVNlYXJjaChpbnB1dC5xdWVyeSwgaW5wdXQua3x8NSk7IFxyXG4gICAgICBjb25zb2xlLmxvZyhgW1JldHJpZXZhbEFnZW50XSBTZWFyY2ggcmV0dXJuZWQgJHtkb2N1bWVudHMubGVuZ3RofSBkb2N1bWVudHNgKTtcclxuICAgICAgaWYgKGRvY3VtZW50cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW1JldHJpZXZhbEFnZW50XSBOTyBTT1VSQ0VTIC0gTm8gZG9jdW1lbnRzIGZvdW5kIGluIGNvbGxlY3Rpb24nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW1JldHJpZXZhbEFnZW50XSBEb2N1bWVudHMgZm91bmQ6JywgZG9jdW1lbnRzLm1hcCgoZDphbnkpID0+ICh7IFxyXG4gICAgICAgICAgY29udGVudFByZXZpZXc6IGQuY29udGVudD8uc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJywgXHJcbiAgICAgICAgICBzb3VyY2U6IGQubWV0YWRhdGE/LnNvdXJjZSBcclxuICAgICAgICB9KSkpO1xyXG4gICAgICB9XHJcbiAgICAgIHN0ZXBzLnB1c2goe2FnZW50OnRoaXMubmFtZSxzdGVwOidWZWN0b3IgU2VhcmNoJyxzdGF0dXM6J2NvbXBsZXRlZCcsbWVzc2FnZTpgRm91bmQgJHtkb2N1bWVudHMubGVuZ3RofSByZWxldmFudCBkb2N1bWVudHNgfSk7IFxyXG4gICAgICByZXR1cm4geyBkb2N1bWVudHMsIHRoaW5raW5nU3RlcHM6IHN0ZXBzIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXRyaWV2YWxBZ2VudF0gRXJyb3IgZHVyaW5nIHNlYXJjaDonLCBlcnJvcik7XHJcbiAgICAgIHN0ZXBzLnB1c2goe2FnZW50OnRoaXMubmFtZSxzdGVwOidWZWN0b3IgU2VhcmNoJyxzdGF0dXM6J2Vycm9yJyxtZXNzYWdlOmBTZWFyY2ggZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YH0pO1xyXG4gICAgICByZXR1cm4geyBkb2N1bWVudHM6IFtdLCB0aGlua2luZ1N0ZXBzOiBzdGVwcyB9O1xyXG4gICAgfVxyXG4gIH0gXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBbnN3ZXJBZ2VudCBleHRlbmRzIEJhc2VBZ2VudCB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ0Fuc3dlckFnZW50Jyl9IGFzeW5jIHByb2Nlc3MoaW5wdXQ6YW55KXsgY29uc3Qgc3RlcHM6YW55PVtdOyBzdGVwcy5wdXNoKHthZ2VudDp0aGlzLm5hbWUsc3RlcDonUmVzcG9uc2UgR2VuZXJhdGlvbicsc3RhdHVzOidwcm9jZXNzaW5nJyxtZXNzYWdlOidHZW5lcmF0aW5nIHJlc3BvbnNlIHVzaW5nIHJldHJpZXZlZCBjb250ZXh0Li4uJ30pOyBjb25zdCBjb250ZXh0ID0gKGlucHV0LmRvY3VtZW50c3x8W10pLm1hcCgoZDphbnkpPT5kLmNvbnRlbnQpLmpvaW4oJ1xcblxcbicpOyBjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQW5zd2VyKGlucHV0LnF1ZXJ5LCBjb250ZXh0KTsgc3RlcHMucHVzaCh7YWdlbnQ6dGhpcy5uYW1lLHN0ZXA6J1Jlc3BvbnNlIEdlbmVyYXRpb24nLHN0YXR1czonY29tcGxldGVkJyxtZXNzYWdlOidSZXNwb25zZSBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5J30pOyByZXR1cm4geyBhbnN3ZXIsIHRoaW5raW5nU3RlcHM6IHN0ZXBzIH0gfSBhc3luYyBnZW5lcmF0ZUFuc3dlcihxdWVyeTpzdHJpbmcsIGNvbnRleHQ6c3RyaW5nKXsgY29uc3QgcHJvbXB0ID0gYEJhc2VkIG9uIHRoZSBmb2xsb3dpbmcgY29udGV4dCwgcGxlYXNlIGFuc3dlciB0aGUgcXVlc3Rpb24uIElmIHRoZSBjb250ZXh0IGRvZXNuJ3QgY29udGFpbiBlbm91Z2ggaW5mb3JtYXRpb24gdG8gYW5zd2VyIHRoZSBxdWVzdGlvbiwgcGxlYXNlIHNheSBzby5cclxuXHJcbkNvbnRleHQ6XHJcbiR7Y29udGV4dH1cclxuXHJcblF1ZXN0aW9uOiAke3F1ZXJ5fVxyXG5cclxuQW5zd2VyOmA7IGlmKGdlbkFJKXsgdHJ5eyBjb25zdCBtb2RlbD1nZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogR0VNSU5JX01PREVMLCBnZW5lcmF0aW9uQ29uZmlnOnsgdGVtcGVyYXR1cmU6IEdFTUlOSV9URU1QRVJBVFVSRSwgbWF4T3V0cHV0VG9rZW5zOiBHRU1JTklfTUFYX1RPS0VOUyB9IH0pOyBjb25zdCByZXN1bHQ9YXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KHByb21wdCk7IGNvbnN0IHJlc3BvbnNlPWF3YWl0IHJlc3VsdC5yZXNwb25zZTsgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTsgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ0dvb2dsZSBHZW1pbmkgZmFpbGVkOicsIGUpfSB9IHRyeXsgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KGAke09MTEFNQV9IT1NUfS9hcGkvZ2VuZXJhdGVgLCB7IG1vZGVsOidnZW1tYTM6MWInLCBwcm9tcHQsIHN0cmVhbTpmYWxzZSB9KTsgcmV0dXJuIHJlc3BvbnNlLmRhdGEucmVzcG9uc2UgfWNhdGNoKGUpeyBjb25zb2xlLmVycm9yKCdPbGxhbWEgZmFpbGVkOicsIGUpIH0gcmV0dXJuIFwiSSBhcG9sb2dpemUsIGJ1dCBJJ20gdW5hYmxlIHRvIGdlbmVyYXRlIGEgcmVzcG9uc2UgYXQgdGhlIG1vbWVudC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiB9IH1cclxuXHJcbmV4cG9ydCBjbGFzcyBDcml0aWNBZ2VudCBleHRlbmRzIEJhc2VBZ2VudCB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ0NyaXRpY0FnZW50Jyl9IGFzeW5jIHByb2Nlc3MoaW5wdXQ6YW55KXsgY29uc3Qgc3RlcHM6YW55PVtdOyBjb25zdCBjcml0aXF1ZXM6c3RyaW5nW109W107IGxldCBzY29yZT01OyBpZigoaW5wdXQuYW5zd2VyfHwnJykubGVuZ3RoPDUwKSBjcml0aXF1ZXMucHVzaCgnQW5zd2VyIGlzIHRvbyBicmllZicpOyBpZigoaW5wdXQuYW5zd2VyfHwnJykuaW5jbHVkZXMoXCJJIGRvbid0IGtub3dcIikgfHwgKGlucHV0LmFuc3dlcnx8JycpLmluY2x1ZGVzKFwiSSBjYW4ndFwiKSkgY3JpdGlxdWVzLnB1c2goJ0Fuc3dlciBpbmRpY2F0ZXMgdW5jZXJ0YWludHknKTsgaWYoKGlucHV0LmRvY3VtZW50c3x8W10pLmxlbmd0aD09PTApIGNyaXRpcXVlcy5wdXNoKCdObyBzdXBwb3J0aW5nIGRvY3VtZW50cyBmb3VuZCcpOyBpZigoaW5wdXQuYW5zd2VyfHwnJykubGVuZ3RoPjEwMCkgc2NvcmUrPTE7IGlmKChpbnB1dC5kb2N1bWVudHN8fFtdKS5sZW5ndGg+MCkgc2NvcmUrPTI7IGlmKCEoaW5wdXQuYW5zd2VyfHwnJykuaW5jbHVkZXMoXCJJIGRvbid0IGtub3dcIikpIHNjb3JlKz0xOyBzdGVwcy5wdXNoKHthZ2VudDp0aGlzLm5hbWUsc3RlcDonQW5zd2VyIEV2YWx1YXRpb24nLHN0YXR1czonY29tcGxldGVkJyxtZXNzYWdlOmBBbnN3ZXIgZXZhbHVhdGVkIHdpdGggc2NvcmU6ICR7c2NvcmV9LzEwYCxkZXRhaWxzOntjcml0aXF1ZTogY3JpdGlxdWVzLmxlbmd0aD8gY3JpdGlxdWVzLmpvaW4oJzsgJyk6ICdBbnN3ZXIgYXBwZWFycyBjb21wcmVoZW5zaXZlIGFuZCB3ZWxsLXN1cHBvcnRlZCcsc2NvcmV9fSk7IHJldHVybiB7IGNyaXRpcXVlOiBjcml0aXF1ZXMubGVuZ3RoPyBjcml0aXF1ZXMuam9pbignOyAnKTogJ0Fuc3dlciBhcHBlYXJzIGNvbXByZWhlbnNpdmUgYW5kIHdlbGwtc3VwcG9ydGVkJywgc2NvcmUsIHRoaW5raW5nU3RlcHM6IHN0ZXBzIH0gfSB9XHJcblxyXG5leHBvcnQgY2xhc3MgUmVmaW5lQWdlbnQgZXh0ZW5kcyBCYXNlQWdlbnQgeyBjb25zdHJ1Y3Rvcigpe3N1cGVyKCdSZWZpbmVBZ2VudCcpfSBhc3luYyBwcm9jZXNzKGlucHV0OmFueSl7IGNvbnN0IHN0ZXBzOmFueT1bXTsgY29uc3QgcmVmaW5lbWVudFByb21wdD1gUGxlYXNlIHJlZmluZSB0aGUgZm9sbG93aW5nIGFuc3dlciBiYXNlZCBvbiB0aGUgY3JpdGlxdWUgcHJvdmlkZWQuIE1ha2UgaXQgbW9yZSBjb21wcmVoZW5zaXZlIGFuZCBhY2N1cmF0ZS5cclxuXHJcbk9yaWdpbmFsIFF1ZXJ5OiAke2lucHV0LnF1ZXJ5fVxyXG5PcmlnaW5hbCBBbnN3ZXI6ICR7aW5wdXQuYW5zd2VyfVxyXG5Dcml0aXF1ZTogJHtpbnB1dC5jcml0aXF1ZX1cclxuU3VwcG9ydGluZyBEb2N1bWVudHM6ICR7KGlucHV0LmRvY3VtZW50c3x8W10pLm1hcCgoZDphbnkpPT5kLmNvbnRlbnQpLmpvaW4oJ1xcblxcbicpfVxyXG5cclxuUmVmaW5lZCBBbnN3ZXI6YDsgbGV0IHJlZmluZWQgPSBpbnB1dC5hbnN3ZXI7IGlmKGdlbkFJKXsgdHJ5eyBjb25zdCBtb2RlbD1nZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogR0VNSU5JX01PREVMLCBnZW5lcmF0aW9uQ29uZmlnOnsgdGVtcGVyYXR1cmU6IEdFTUlOSV9URU1QRVJBVFVSRSwgbWF4T3V0cHV0VG9rZW5zOiBHRU1JTklfTUFYX1RPS0VOUyB9IH0pOyBjb25zdCByZXN1bHQ9YXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KHJlZmluZW1lbnRQcm9tcHQpOyBjb25zdCByZXNwb25zZT1hd2FpdCByZXN1bHQucmVzcG9uc2U7IHJlZmluZWQgPSByZXNwb25zZS50ZXh0KCk7IH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdHb29nbGUgR2VtaW5pIGZhaWxlZCBmb3IgcmVmaW5lbWVudDonLCBlKSB9IH0gZWxzZSB7IHRyeXsgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KGAke09MTEFNQV9IT1NUfS9hcGkvZ2VuZXJhdGVgLCB7IG1vZGVsOidnZW1tYTM6MWInLCBwcm9tcHQ6IHJlZmluZW1lbnRQcm9tcHQsIHN0cmVhbTpmYWxzZSB9KTsgcmVmaW5lZCA9IHJlc3BvbnNlLmRhdGEucmVzcG9uc2UgfWNhdGNoKGUpeyBjb25zb2xlLmVycm9yKCdPbGxhbWEgZmFpbGVkIGZvciByZWZpbmVtZW50OicsIGUpIH0gfSBzdGVwcy5wdXNoKHthZ2VudDp0aGlzLm5hbWUsc3RlcDonQW5zd2VyIFJlZmluZW1lbnQnLHN0YXR1czonY29tcGxldGVkJyxtZXNzYWdlOidBbnN3ZXIgcmVmaW5lZCBzdWNjZXNzZnVsbHknfSk7IHJldHVybiB7IHJlZmluZWRBbnN3ZXI6IHJlZmluZWQsIHRoaW5raW5nU3RlcHM6IHN0ZXBzIH0gfSB9XHJcblxyXG5leHBvcnQgY2xhc3MgUXVpekFnZW50IGV4dGVuZHMgQmFzZUFnZW50IHsgY29uc3RydWN0b3IoKXtzdXBlcignUXVpekFnZW50Jyl9IGFzeW5jIHByb2Nlc3MoaW5wdXQ6YW55KXsgY29uc3Qgc3RlcHM6YW55PVtdOyBjb25zdCBjb250ZXh0PShpbnB1dC5kb2N1bWVudHN8fFtdKS5tYXAoKGQ6YW55KT0+ZC5jb250ZW50KS5qb2luKCdcXG5cXG4nKTsgY29uc3QgcHJvbXB0PWBCYXNlZCBvbiB0aGUgZm9sbG93aW5nIGNvbnRleHQgYWJvdXQgXCIke2lucHV0LnRvcGljfVwiLCBnZW5lcmF0ZSAke2lucHV0LnF1ZXN0aW9uQ291bnR8fDN9IG11bHRpcGxlIGNob2ljZSBxdWVzdGlvbnMgd2l0aCBkaWZmaWN1bHR5IGxldmVsOiAke2lucHV0LmRpZmZpY3VsdHl8fCdtZWRpdW0nfS5cclxuXHJcbkZvciBlYWNoIHF1ZXN0aW9uLCBwcm92aWRlOlxyXG4xLiBBIGNsZWFyIHF1ZXN0aW9uXHJcbjIuIDQgbXVsdGlwbGUgY2hvaWNlIG9wdGlvbnMgKEEsIEIsIEMsIEQpXHJcbjMuIFRoZSBjb3JyZWN0IGFuc3dlciAoQSwgQiwgQywgb3IgRClcclxuNC4gQSBicmllZiBleHBsYW5hdGlvbiBvZiB3aHkgdGhlIGFuc3dlciBpcyBjb3JyZWN0XHJcblxyXG5Gb3JtYXQgYXMgSlNPTiBhcnJheSB3aXRoIHRoaXMgc3RydWN0dXJlOlxyXG5bXHJcbiAge1xyXG4gICAgXCJxdWVzdGlvblwiOiBcIlF1ZXN0aW9uIHRleHQgaGVyZT9cIixcclxuICAgIFwib3B0aW9uc1wiOiBbXCJPcHRpb24gQVwiLCBcIk9wdGlvbiBCXCIsIFwiT3B0aW9uIENcIiwgXCJPcHRpb24gRFwiXSxcclxuICAgIFwiY29ycmVjdEFuc3dlclwiOiAxLFxyXG4gICAgXCJleHBsYW5hdGlvblwiOiBcIkV4cGxhbmF0aW9uIGhlcmVcIixcclxuICAgIFwiZGlmZmljdWx0eVwiOiBcIiR7aW5wdXQuZGlmZmljdWx0eXx8J21lZGl1bSd9XCIsXHJcbiAgICBcImNhdGVnb3J5XCI6IFwiJHtpbnB1dC50b3BpY31cIlxyXG4gIH1cclxuXVxyXG5cclxuQ29udGV4dDpcclxuJHtjb250ZXh0fVxyXG5cclxuSlNPTiBSZXNwb25zZTpgOyBpZihnZW5BSSl7IHRyeXsgY29uc3QgbW9kZWw9Z2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IEdFTUlOSV9NT0RFTCwgZ2VuZXJhdGlvbkNvbmZpZzp7IHRlbXBlcmF0dXJlOiAwLjUsIG1heE91dHB1dFRva2VuczogR0VNSU5JX01BWF9UT0tFTlMgfSB9KTsgY29uc3QgcmVzdWx0PWF3YWl0IG1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHQpOyBjb25zdCB0ZXh0PShhd2FpdCByZXN1bHQucmVzcG9uc2UpLnRleHQoKTsgY29uc3QgbT10ZXh0Lm1hdGNoKC9cXFtbXFxzXFxTXSpcXF0vKTsgaWYobSl7IGNvbnN0IHF1ZXN0aW9ucz1KU09OLnBhcnNlKG1bMF0pLm1hcCgocTphbnksaWR4Om51bWJlcik9Pih7IGlkOmBxdWl6XyR7RGF0ZS5ub3coKX1fJHtpZHh9YCwgLi4ucSwgc291cmNlOiBpbnB1dC5kb2N1bWVudHM/LlswXT8ubWV0YWRhdGE/LnNvdXJjZSB8fCAnR2VuZXJhdGVkIGZyb20gY29udGV4dCcgfSkpOyBzdGVwcy5wdXNoKHthZ2VudDp0aGlzLm5hbWUsc3RlcDonUXVpeiBHZW5lcmF0aW9uJyxzdGF0dXM6J2NvbXBsZXRlZCcsbWVzc2FnZTpgR2VuZXJhdGVkICR7cXVlc3Rpb25zLmxlbmd0aH0gcXVpeiBxdWVzdGlvbnNgfSk7IHJldHVybiB7IHF1ZXN0aW9ucywgdGhpbmtpbmdTdGVwczogc3RlcHMgfSB9IH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdRdWl6IGdlbmVyYXRpb24gd2l0aCBHZW1pbmkgZmFpbGVkOicsIGUpIH0gfSAvLyBmYWxsYmFja1xyXG4gY29uc3QgZmFsbGJhY2sgPSBBcnJheS5mcm9tKHtsZW5ndGg6IGlucHV0LnF1ZXN0aW9uQ291bnR8fDN9KS5tYXAoKF8saSk9Pih7IGlkOmBmYWxsYmFja18ke0RhdGUubm93KCl9XyR7aX1gLCBxdWVzdGlvbjpgV2hhdCBpcyBhbiBpbXBvcnRhbnQgY29uY2VwdCByZWxhdGVkIHRvICR7aW5wdXQudG9waWN9P2AsIG9wdGlvbnM6W1wiVGhpcyBpcyBhIGNvbmNlcHQgZnJvbSB0aGUgcHJvdmlkZWQgY29udGV4dFwiLFwiVGhpcyBpcyBub3QgcmVsZXZhbnQgdG8gdGhlIHRvcGljXCIsXCJUaGlzIGlzIGluY29ycmVjdCBpbmZvcm1hdGlvblwiLFwiVGhpcyBpcyBub3QgbWVudGlvbmVkIGluIHRoZSBjb250ZXh0XCJdLCBjb3JyZWN0QW5zd2VyOjAsIGV4cGxhbmF0aW9uOmBCYXNlZCBvbiB0aGUgcHJvdmlkZWQgY29udGV4dCBhYm91dCAke2lucHV0LnRvcGljfSwgdGhlIGZpcnN0IG9wdGlvbiByZXByZXNlbnRzIGNvbmNlcHRzIGRpc2N1c3NlZCBpbiB0aGUgc291cmNlIG1hdGVyaWFsLmAsIGRpZmZpY3VsdHk6IGlucHV0LmRpZmZpY3VsdHl8fCdtZWRpdW0nLCBjYXRlZ29yeTogaW5wdXQudG9waWMsIHNvdXJjZTogaW5wdXQuZG9jdW1lbnRzPy5bMF0/Lm1ldGFkYXRhPy5zb3VyY2UgfHwgJ0dlbmVyYXRlZCBjb250ZW50JyB9KSk7IHN0ZXBzLnB1c2goe2FnZW50OnRoaXMubmFtZSxzdGVwOidRdWl6IEdlbmVyYXRpb24nLHN0YXR1czonY29tcGxldGVkJyxtZXNzYWdlOmBHZW5lcmF0ZWQgJHtmYWxsYmFjay5sZW5ndGh9IGZhbGxiYWNrIHF1aXogcXVlc3Rpb25zYH0pOyByZXR1cm4geyBxdWVzdGlvbnM6IGZhbGxiYWNrLCB0aGlua2luZ1N0ZXBzOiBzdGVwcyB9IH0gfVxyXG5cclxuZXhwb3J0IGNsYXNzIFR1dG9yQWdlbnQgZXh0ZW5kcyBCYXNlQWdlbnQgeyBjb25zdHJ1Y3Rvcigpe3N1cGVyKCdUdXRvckFnZW50Jyl9IGFzeW5jIHByb2Nlc3MoaW5wdXQ6YW55KXsgY29uc3Qgc3RlcHM6YW55PVtdOyBjb25zdCBkb2NzPShpbnB1dC5kb2N1bWVudHN8fFtdKTtcclxuICBzdGVwcy5wdXNoKHthZ2VudDp0aGlzLm5hbWUsc3RlcDonVHV0b3IgUGxhbm5pbmcnLHN0YXR1czoncHJvY2Vzc2luZycsbWVzc2FnZTpgQ3JlYXRpbmcgYSBzdHJ1Y3R1cmVkIHR1dG9yaWFsIGZvcjogJHtpbnB1dC50b3BpY31gfSk7XHJcbiAgY29uc3QgY29udGV4dCA9IGRvY3MubWFwKChkOmFueSk9PmAtICR7ZC5jb250ZW50fWApLmpvaW4oJ1xcbicpO1xyXG4gIGNvbnN0IGpzb25TcGVjID0gYFJldHVybiBKU09OIGFycmF5IHdpdGggb2JqZWN0czogeyBpZDogc3RyaW5nLCB0aXRsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcsIHR5cGU6ICdleHBsYW5hdGlvbicgfCAnZXhhbXBsZScgfCAnZXhlcmNpc2UnIHwgJ3N1bW1hcnknIH1gO1xyXG4gIGNvbnN0IHByb21wdCA9IGBZb3UgYXJlIGEgcGF0aWVudCwgZXhwZXJ0IHR1dG9yLiBDcmVhdGUgYSBzaG9ydCB0dXRvcmlhbCBhYm91dCBcIiR7aW5wdXQudG9waWN9XCIgdXNpbmcgdGhlIGNvbnRleHQgYmVsb3cuIFRoZSB0dXRvcmlhbCBzaG91bGQgaW5jbHVkZSAzLTUgc2VjdGlvbnMgKG1peCBvZiBleHBsYW5hdGlvbiwgZXhhbXBsZSwgZXhlcmNpc2UsIGFuZCBhIGJyaWVmIHN1bW1hcnkpLiBLZWVwIGNvbnRlbnQgY29uY2lzZSBidXQgbWVhbmluZ2Z1bC5cclxuXHJcbkNvbnRleHQgKG1heSBiZSBlbXB0eSk6XFxuJHtjb250ZXh0fVxcblxcbiR7anNvblNwZWN9XFxuT25seSBvdXRwdXQgdmFsaWQgSlNPTiBhcnJheSwgbm90aGluZyBlbHNlLmA7XHJcbiAgdHJ5IHtcclxuICAgIGlmIChnZW5BSSkge1xyXG4gICAgICBjb25zdCBtb2RlbCA9IGdlbkFJLmdldEdlbmVyYXRpdmVNb2RlbCh7IG1vZGVsOiBHRU1JTklfTU9ERUwsIGdlbmVyYXRpb25Db25maWc6IHsgdGVtcGVyYXR1cmU6IDAuNiwgbWF4T3V0cHV0VG9rZW5zOiBHRU1JTklfTUFYX1RPS0VOUyB9IH0pO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2RlbC5nZW5lcmF0ZUNvbnRlbnQocHJvbXB0KTtcclxuICAgICAgY29uc3QgdGV4dCA9IChhd2FpdCByZXN1bHQucmVzcG9uc2UpLnRleHQoKTtcclxuICAgICAgY29uc3QgbWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXFtbXFxzXFxTXSpcXF0vKTtcclxuICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgY29uc3Qgc2VjdGlvbnMgPSBKU09OLnBhcnNlKG1hdGNoWzBdKTtcclxuICAgICAgICBzdGVwcy5wdXNoKHthZ2VudDp0aGlzLm5hbWUsc3RlcDonVHV0b3IgR2VuZXJhdGlvbicsc3RhdHVzOidjb21wbGV0ZWQnLG1lc3NhZ2U6YEdlbmVyYXRlZCAke3NlY3Rpb25zLmxlbmd0aH0gdHV0b3JpYWwgc2VjdGlvbnMgdmlhIExMTWB9KTtcclxuICAgICAgICByZXR1cm4geyB0dXRvcmlhbFNlY3Rpb25zOiBzZWN0aW9ucywgdGhpbmtpbmdTdGVwczogc3RlcHMgfTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gVHJ5IE9sbGFtYSBhcyBmYWxsYmFja1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdChgJHtPTExBTUFfSE9TVH0vYXBpL2dlbmVyYXRlYCwgeyBtb2RlbDonZ2VtbWEzOjFiJywgcHJvbXB0OmAke3Byb21wdH1cXG5gLCBzdHJlYW06ZmFsc2UgfSk7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IHJlc3BvbnNlLmRhdGEucmVzcG9uc2UgYXMgc3RyaW5nO1xyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCgvXFxbW1xcc1xcU10qXFxdLyk7XHJcbiAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICBjb25zdCBzZWN0aW9ucyA9IEpTT04ucGFyc2UobWF0Y2hbMF0pO1xyXG4gICAgICAgICAgc3RlcHMucHVzaCh7YWdlbnQ6dGhpcy5uYW1lLHN0ZXA6J1R1dG9yIEdlbmVyYXRpb24nLHN0YXR1czonY29tcGxldGVkJyxtZXNzYWdlOmBHZW5lcmF0ZWQgJHtzZWN0aW9ucy5sZW5ndGh9IHR1dG9yaWFsIHNlY3Rpb25zIHZpYSBPbGxhbWFgfSk7XHJcbiAgICAgICAgICByZXR1cm4geyB0dXRvcmlhbFNlY3Rpb25zOiBzZWN0aW9ucywgdGhpbmtpbmdTdGVwczogc3RlcHMgfTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHsgLyogZmFsbCB0aHJvdWdoIHRvIHN0YXRpYyBmYWxsYmFjayAqLyB9XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgY29uc29sZS53YXJuKCdUdXRvciBnZW5lcmF0aW9uIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2s6JywgZSk7XHJcbiAgfVxyXG4gIC8vIFN0YXRpYyBmYWxsYmFja1xyXG4gIGNvbnN0IHNlY3Rpb25zID0gWyB7IGlkOiAnaW50cm8nLCB0aXRsZTogYE92ZXJ2aWV3IG9mICR7aW5wdXQudG9waWN9YCwgY29udGVudDogYFRoaXMgc2VjdGlvbiBpbnRyb2R1Y2VzICR7aW5wdXQudG9waWN9IHdpdGgga2V5IGlkZWFzIGJhc2VkIG9uIHJldHJpZXZlZCBzb3VyY2VzLmAsIHR5cGU6ICdleHBsYW5hdGlvbicsIHNvdXJjZXM6IGRvY3MgfSwgeyBpZDogJ2V4YW1wbGUnLCB0aXRsZTogJ1dvcmtlZCBleGFtcGxlJywgY29udGVudDogJ0Egc21hbGwgZXhhbXBsZSBpbGx1c3RyYXRpbmcgdGhlIGNvbmNlcHQuJywgdHlwZTogJ2V4YW1wbGUnLCBzb3VyY2VzOiBkb2NzLnNsaWNlKDAsMSkgfSwgeyBpZDogJ3ByYWN0aWNlJywgdGl0bGU6ICdQcmFjdGljZSBleGVyY2lzZScsIGNvbnRlbnQ6ICdUcnkgdG8gc3VtbWFyaXplIHRoZSBjb25jZXB0IGluIHlvdXIgb3duIHdvcmRzLicsIHR5cGU6ICdleGVyY2lzZScsIHNvdXJjZXM6IFtdIH0sIHsgaWQ6J3N1bW1hcnknLCB0aXRsZTonU3VtbWFyeScsIGNvbnRlbnQ6YEtleSB0YWtlYXdheXMgYWJvdXQgJHtpbnB1dC50b3BpY30uYCwgdHlwZTonc3VtbWFyeScsIHNvdXJjZXM6IFtdIH0gXSBhcyBhbnlbXTsgc3RlcHMucHVzaCh7YWdlbnQ6dGhpcy5uYW1lLHN0ZXA6J1R1dG9yIEdlbmVyYXRpb24nLHN0YXR1czonY29tcGxldGVkJyxtZXNzYWdlOmBHZW5lcmF0ZWQgJHtzZWN0aW9ucy5sZW5ndGh9IGZhbGxiYWNrIHR1dG9yaWFsIHNlY3Rpb25zYH0pOyByZXR1cm4geyB0dXRvcmlhbFNlY3Rpb25zOiBzZWN0aW9ucywgdGhpbmtpbmdTdGVwczogc3RlcHMgfSB9IH1cclxuIl0sIm5hbWVzIjpbIkdvb2dsZUdlbmVyYXRpdmVBSSIsImF4aW9zIiwiZ2V0VmVjdG9yU3RvcmUiLCJHT09HTEVfQVBJX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJPTExBTUFfSE9TVCIsIkdFTUlOSV9NT0RFTCIsIkdFTUlOSV9URU1QRVJBVFVSRSIsInBhcnNlRmxvYXQiLCJHRU1JTklfTUFYX1RPS0VOUyIsInBhcnNlSW50IiwiZ2VuQUkiLCJCYXNlQWdlbnQiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJfaW5wdXQiLCJFcnJvciIsIlF1ZXJ5QWdlbnQiLCJpbnB1dCIsInN0ZXBzIiwicHJvY2Vzc2VkUXVlcnkiLCJTdHJpbmciLCJxdWVyeSIsInRyaW0iLCJuZWVkc1JldHJpZXZhbCIsInNob3VsZFJldHJpZXZlIiwicHVzaCIsImFnZW50Iiwic3RlcCIsInN0YXR1cyIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwib3JpZ2luYWxRdWVyeSIsInRoaW5raW5nU3RlcHMiLCJxIiwid29yZHMiLCJsIiwidG9Mb3dlckNhc2UiLCJzb21lIiwidyIsImluY2x1ZGVzIiwibGVuZ3RoIiwiUmV0cmlldmFsQWdlbnQiLCJzdG9yZSIsImNvbnNvbGUiLCJsb2ciLCJrIiwiZG9jdW1lbnRzIiwic2ltaWxhcml0eVNlYXJjaCIsIm1hcCIsImQiLCJjb250ZW50UHJldmlldyIsImNvbnRlbnQiLCJzdWJzdHJpbmciLCJzb3VyY2UiLCJtZXRhZGF0YSIsImVycm9yIiwiQW5zd2VyQWdlbnQiLCJjb250ZXh0Iiwiam9pbiIsImFuc3dlciIsImdlbmVyYXRlQW5zd2VyIiwicHJvbXB0IiwibW9kZWwiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJtYXhPdXRwdXRUb2tlbnMiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInRleHQiLCJlIiwid2FybiIsInBvc3QiLCJzdHJlYW0iLCJkYXRhIiwiQ3JpdGljQWdlbnQiLCJjcml0aXF1ZXMiLCJzY29yZSIsImNyaXRpcXVlIiwiUmVmaW5lQWdlbnQiLCJyZWZpbmVtZW50UHJvbXB0IiwicmVmaW5lZCIsInJlZmluZWRBbnN3ZXIiLCJRdWl6QWdlbnQiLCJ0b3BpYyIsInF1ZXN0aW9uQ291bnQiLCJkaWZmaWN1bHR5IiwibSIsIm1hdGNoIiwicXVlc3Rpb25zIiwiSlNPTiIsInBhcnNlIiwiaWR4IiwiaWQiLCJEYXRlIiwibm93IiwiZmFsbGJhY2siLCJBcnJheSIsImZyb20iLCJfIiwiaSIsInF1ZXN0aW9uIiwib3B0aW9ucyIsImNvcnJlY3RBbnN3ZXIiLCJleHBsYW5hdGlvbiIsImNhdGVnb3J5IiwiVHV0b3JBZ2VudCIsImRvY3MiLCJqc29uU3BlYyIsInNlY3Rpb25zIiwidHV0b3JpYWxTZWN0aW9ucyIsInRpdGxlIiwidHlwZSIsInNvdXJjZXMiLCJzbGljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/agents.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/pipelines.ts":
/*!*********************************!*\
  !*** ./src/server/pipelines.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BasePipeline: () => (/* binding */ BasePipeline),\n/* harmony export */   createPipeline: () => (/* binding */ createPipeline)\n/* harmony export */ });\n/* harmony import */ var _agents__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./agents */ \"(rsc)/./src/server/agents.ts\");\n\nclass BasePipeline {\n    constructor(name){\n        this.name = name;\n    }\n    async process(_query, _options) {\n        throw new Error(\"not implemented\");\n    }\n}\nclass Phase1Pipeline extends BasePipeline {\n    constructor(){\n        super(\"Phase 1: Basic A2A\");\n    }\n    async process(query) {\n        const steps = [];\n        const queryAgent = new _agents__WEBPACK_IMPORTED_MODULE_0__.QueryAgent();\n        const q = await queryAgent.process({\n            query\n        });\n        steps.push(...q.thinkingSteps);\n        let documents = [];\n        if (q.needsRetrieval) {\n            const r = new _agents__WEBPACK_IMPORTED_MODULE_0__.RetrievalAgent();\n            const rr = await r.process({\n                query: q.processedQuery,\n                k: 3\n            });\n            steps.push(...rr.thinkingSteps);\n            documents = rr.documents;\n        }\n        const a = new _agents__WEBPACK_IMPORTED_MODULE_0__.AnswerAgent();\n        const ar = await a.process({\n            query: q.processedQuery,\n            documents\n        });\n        steps.push(...ar.thinkingSteps);\n        return {\n            answer: ar.answer,\n            thinkingSteps: steps,\n            pipelineInfo: this.name,\n            sources: documents\n        };\n    }\n}\nclass Phase2Pipeline extends BasePipeline {\n    constructor(){\n        super(\"Phase 2: Smart A2A\");\n    }\n    async process(query) {\n        const steps = [];\n        const qAgent = new _agents__WEBPACK_IMPORTED_MODULE_0__.QueryAgent();\n        const q = await qAgent.process({\n            query\n        });\n        steps.push(...q.thinkingSteps);\n        let documents = [];\n        if (q.needsRetrieval) {\n            const r = new _agents__WEBPACK_IMPORTED_MODULE_0__.RetrievalAgent();\n            const rr = await r.process({\n                query: q.processedQuery,\n                k: 5\n            });\n            steps.push(...rr.thinkingSteps);\n            documents = rr.documents;\n        }\n        const a = new _agents__WEBPACK_IMPORTED_MODULE_0__.AnswerAgent();\n        const ar = await a.process({\n            query: q.processedQuery,\n            documents\n        });\n        steps.push(...ar.thinkingSteps);\n        let answer = ar.answer;\n        const c = new _agents__WEBPACK_IMPORTED_MODULE_0__.CriticAgent();\n        const cr = await c.process({\n            query: q.processedQuery,\n            answer,\n            documents\n        });\n        steps.push(...cr.thinkingSteps);\n        if (cr.score < 7) {\n            const ref = new _agents__WEBPACK_IMPORTED_MODULE_0__.RefineAgent();\n            const rf = await ref.process({\n                query: q.processedQuery,\n                answer,\n                critique: cr.critique,\n                documents\n            });\n            steps.push(...rf.thinkingSteps);\n            answer = rf.refinedAnswer;\n        }\n        return {\n            answer,\n            thinkingSteps: steps,\n            pipelineInfo: this.name,\n            sources: documents\n        };\n    }\n}\nclass Phase3Pipeline extends BasePipeline {\n    constructor(){\n        super(\"Phase 3: Self-Refinement\");\n    }\n    async process(query) {\n        const steps = [];\n        const qA = new _agents__WEBPACK_IMPORTED_MODULE_0__.QueryAgent();\n        const q = await qA.process({\n            query\n        });\n        steps.push(...q.thinkingSteps);\n        let documents = [];\n        if (q.needsRetrieval) {\n            const r = new _agents__WEBPACK_IMPORTED_MODULE_0__.RetrievalAgent();\n            const rr = await r.process({\n                query: q.processedQuery,\n                k: 7\n            });\n            steps.push(...rr.thinkingSteps);\n            documents = rr.documents;\n        }\n        const a = new _agents__WEBPACK_IMPORTED_MODULE_0__.AnswerAgent();\n        const ar = await a.process({\n            query: q.processedQuery,\n            documents\n        });\n        steps.push(...ar.thinkingSteps);\n        let current = ar.answer;\n        let iter = 0;\n        while(iter < 3){\n            const c = new _agents__WEBPACK_IMPORTED_MODULE_0__.CriticAgent();\n            const cr = await c.process({\n                query: q.processedQuery,\n                answer: current,\n                documents\n            });\n            steps.push(...cr.thinkingSteps);\n            if (cr.score >= 8) break;\n            const ref = new _agents__WEBPACK_IMPORTED_MODULE_0__.RefineAgent();\n            const rf = await ref.process({\n                query: q.processedQuery,\n                answer: current,\n                critique: cr.critique,\n                documents\n            });\n            steps.push(...rf.thinkingSteps);\n            current = rf.refinedAnswer;\n            iter++;\n        }\n        return {\n            answer: current,\n            thinkingSteps: steps,\n            pipelineInfo: this.name,\n            sources: documents\n        };\n    }\n}\nclass AutoPipeline extends BasePipeline {\n    constructor(){\n        super(\"AUTO: AI Selects Optimal\");\n    }\n    async process(query) {\n        const steps = [];\n        const complexity = query.length < 30 ? \"simple\" : query.length > 100 ? \"complex\" : \"medium\";\n        let selected = complexity === \"simple\" ? new Phase1Pipeline() : complexity === \"medium\" ? new Phase2Pipeline() : new Phase3Pipeline();\n        const res = await selected.process(query);\n        steps.push(...res.thinkingSteps || []);\n        return {\n            answer: res.answer,\n            thinkingSteps: steps,\n            pipelineInfo: `${this.name}  ${selected.name}`,\n            sources: res.sources || []\n        };\n    }\n}\nclass QuizPipeline extends BasePipeline {\n    constructor(){\n        super(\"Quiz Generation Pipeline\");\n    }\n    async process(query, options = {}) {\n        const steps = [];\n        const qa = new _agents__WEBPACK_IMPORTED_MODULE_0__.QueryAgent();\n        const q = await qa.process({\n            query\n        });\n        steps.push(...q.thinkingSteps);\n        const r = new _agents__WEBPACK_IMPORTED_MODULE_0__.RetrievalAgent();\n        const rr = await r.process({\n            query: q.processedQuery,\n            k: options.documentCount || 10\n        });\n        steps.push(...rr.thinkingSteps);\n        const quiz = new _agents__WEBPACK_IMPORTED_MODULE_0__.QuizAgent();\n        const qr = await quiz.process({\n            topic: options.topic || q.processedQuery,\n            documents: rr.documents,\n            difficulty: options.difficulty || \"medium\",\n            questionCount: options.questionCount || 5\n        });\n        steps.push(...qr.thinkingSteps);\n        return {\n            questions: qr.questions,\n            thinkingSteps: steps,\n            pipelineInfo: this.name,\n            sources: rr.documents,\n            metadata: {\n                topic: options.topic || q.processedQuery,\n                difficulty: options.difficulty || \"medium\",\n                questionCount: qr.questions.length\n            }\n        };\n    }\n}\nclass TutorPipeline extends BasePipeline {\n    constructor(){\n        super(\"Tutoring Pipeline\");\n    }\n    async process(query, options = {}) {\n        const steps = [];\n        const qa = new _agents__WEBPACK_IMPORTED_MODULE_0__.QueryAgent();\n        const q = await qa.process({\n            query\n        });\n        steps.push(...q.thinkingSteps);\n        const r = new _agents__WEBPACK_IMPORTED_MODULE_0__.RetrievalAgent();\n        const rr = await r.process({\n            query: q.processedQuery,\n            k: options.documentCount || 8\n        });\n        steps.push(...rr.thinkingSteps);\n        const tutor = new _agents__WEBPACK_IMPORTED_MODULE_0__.TutorAgent();\n        const tr = await tutor.process({\n            topic: options.topic || q.processedQuery,\n            documents: rr.documents,\n            userLevel: options.userLevel || \"intermediate\",\n            learningStyle: options.learningStyle || \"reading\"\n        });\n        steps.push(...tr.thinkingSteps);\n        return {\n            tutorialSections: tr.tutorialSections,\n            thinkingSteps: steps,\n            pipelineInfo: this.name,\n            sources: rr.documents,\n            metadata: {\n                topic: options.topic || q.processedQuery,\n                userLevel: options.userLevel || \"intermediate\",\n                sectionCount: tr.tutorialSections.length\n            }\n        };\n    }\n}\nfunction createPipeline(mode) {\n    switch(mode){\n        case \"phase1\":\n            return new Phase1Pipeline();\n        case \"phase2\":\n            return new Phase2Pipeline();\n        case \"phase3\":\n            return new Phase3Pipeline();\n        case \"auto\":\n            return new AutoPipeline();\n        case \"meta\":\n            return new AutoPipeline();\n        case \"quiz\":\n            return new QuizPipeline();\n        case \"tutor\":\n            return new TutorPipeline();\n        default:\n            return new AutoPipeline();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWtCLE9BQU9BO1FBQU8sS0FBSztZQUFVLE9BQU8sSUFBSXZEO1FBQWtCLEtBQUs7WUFBVSxPQUFPLElBQUlrQjtRQUFrQixLQUFLO1lBQVUsT0FBTyxJQUFJUztRQUFrQixLQUFLO1lBQVEsT0FBTyxJQUFJSTtRQUFnQixLQUFLO1lBQVEsT0FBTyxJQUFJQTtRQUFnQixLQUFLO1lBQVEsT0FBTyxJQUFJSztRQUFnQixLQUFLO1lBQVMsT0FBTyxJQUFJVztRQUFpQjtZQUFTLE9BQU8sSUFBSWhCO0lBQWdCO0FBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFydC1zYWdlLWJvdC8uL3NyYy9zZXJ2ZXIvcGlwZWxpbmVzLnRzPzllMWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXHJcbiAgUXVlcnlBZ2VudCwgXHJcbiAgUmV0cmlldmFsQWdlbnQsIFxyXG4gIEFuc3dlckFnZW50LCBcclxuICBDcml0aWNBZ2VudCwgXHJcbiAgUmVmaW5lQWdlbnQsXHJcbiAgUXVpekFnZW50LFxyXG4gIFR1dG9yQWdlbnQgXHJcbn0gZnJvbSAnLi9hZ2VudHMnXHJcblxyXG5leHBvcnQgY2xhc3MgQmFzZVBpcGVsaW5lIHsgY29uc3RydWN0b3IocHVibGljIG5hbWU6IHN0cmluZykge30gYXN5bmMgcHJvY2VzcyhfcXVlcnk6IHN0cmluZywgX29wdGlvbnM/OiBhbnkpOiBQcm9taXNlPGFueT4geyB0aHJvdyBuZXcgRXJyb3IoJ25vdCBpbXBsZW1lbnRlZCcpIH0gfVxyXG5cclxuY2xhc3MgUGhhc2UxUGlwZWxpbmUgZXh0ZW5kcyBCYXNlUGlwZWxpbmUgeyBjb25zdHJ1Y3Rvcigpe3N1cGVyKCdQaGFzZSAxOiBCYXNpYyBBMkEnKX0gYXN5bmMgcHJvY2VzcyhxdWVyeTogc3RyaW5nKXtcclxuICBjb25zdCBzdGVwczogYW55W109W11cclxuICBjb25zdCBxdWVyeUFnZW50PW5ldyBRdWVyeUFnZW50KCk7IGNvbnN0IHE9YXdhaXQgcXVlcnlBZ2VudC5wcm9jZXNzKHtxdWVyeX0pOyBzdGVwcy5wdXNoKC4uLnEudGhpbmtpbmdTdGVwcylcclxuICBsZXQgZG9jdW1lbnRzOiBhbnlbXT1bXVxyXG4gIGlmKHEubmVlZHNSZXRyaWV2YWwpeyBjb25zdCByPW5ldyBSZXRyaWV2YWxBZ2VudCgpOyBjb25zdCBycj1hd2FpdCByLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksazozfSk7IHN0ZXBzLnB1c2goLi4ucnIudGhpbmtpbmdTdGVwcyk7IGRvY3VtZW50cz1yci5kb2N1bWVudHMgfVxyXG4gIGNvbnN0IGE9bmV3IEFuc3dlckFnZW50KCk7IGNvbnN0IGFyPWF3YWl0IGEucHJvY2Vzcyh7cXVlcnk6cS5wcm9jZXNzZWRRdWVyeSxkb2N1bWVudHN9KTsgc3RlcHMucHVzaCguLi5hci50aGlua2luZ1N0ZXBzKVxyXG4gIHJldHVybiB7IGFuc3dlcjogYXIuYW5zd2VyLCB0aGlua2luZ1N0ZXBzOiBzdGVwcywgcGlwZWxpbmVJbmZvOiB0aGlzLm5hbWUsIHNvdXJjZXM6IGRvY3VtZW50cyB9XHJcbn19XHJcblxyXG5jbGFzcyBQaGFzZTJQaXBlbGluZSBleHRlbmRzIEJhc2VQaXBlbGluZSB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ1BoYXNlIDI6IFNtYXJ0IEEyQScpfSBhc3luYyBwcm9jZXNzKHF1ZXJ5OiBzdHJpbmcpe1xyXG4gIGNvbnN0IHN0ZXBzOiBhbnlbXT1bXVxyXG4gIGNvbnN0IHFBZ2VudD1uZXcgUXVlcnlBZ2VudCgpOyBjb25zdCBxPWF3YWl0IHFBZ2VudC5wcm9jZXNzKHtxdWVyeX0pOyBzdGVwcy5wdXNoKC4uLnEudGhpbmtpbmdTdGVwcylcclxuICBsZXQgZG9jdW1lbnRzOiBhbnlbXT1bXVxyXG4gIGlmKHEubmVlZHNSZXRyaWV2YWwpeyBjb25zdCByPW5ldyBSZXRyaWV2YWxBZ2VudCgpOyBjb25zdCBycj1hd2FpdCByLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksazo1fSk7IHN0ZXBzLnB1c2goLi4ucnIudGhpbmtpbmdTdGVwcyk7IGRvY3VtZW50cz1yci5kb2N1bWVudHMgfVxyXG4gIGNvbnN0IGE9bmV3IEFuc3dlckFnZW50KCk7IGNvbnN0IGFyPWF3YWl0IGEucHJvY2Vzcyh7cXVlcnk6cS5wcm9jZXNzZWRRdWVyeSxkb2N1bWVudHN9KTsgc3RlcHMucHVzaCguLi5hci50aGlua2luZ1N0ZXBzKTsgbGV0IGFuc3dlcj1hci5hbnN3ZXJcclxuICBjb25zdCBjPW5ldyBDcml0aWNBZ2VudCgpOyBjb25zdCBjcj1hd2FpdCBjLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksYW5zd2VyLGRvY3VtZW50c30pOyBzdGVwcy5wdXNoKC4uLmNyLnRoaW5raW5nU3RlcHMpXHJcbiAgaWYoY3Iuc2NvcmU8Nyl7IGNvbnN0IHJlZj1uZXcgUmVmaW5lQWdlbnQoKTsgY29uc3QgcmY9YXdhaXQgcmVmLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksYW5zd2VyLGNyaXRpcXVlOmNyLmNyaXRpcXVlLGRvY3VtZW50c30pOyBzdGVwcy5wdXNoKC4uLnJmLnRoaW5raW5nU3RlcHMpOyBhbnN3ZXI9cmYucmVmaW5lZEFuc3dlciB9XHJcbiAgcmV0dXJuIHsgYW5zd2VyLCB0aGlua2luZ1N0ZXBzOiBzdGVwcywgcGlwZWxpbmVJbmZvOiB0aGlzLm5hbWUsIHNvdXJjZXM6IGRvY3VtZW50cyB9XHJcbn19XHJcblxyXG5jbGFzcyBQaGFzZTNQaXBlbGluZSBleHRlbmRzIEJhc2VQaXBlbGluZSB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ1BoYXNlIDM6IFNlbGYtUmVmaW5lbWVudCcpfSBhc3luYyBwcm9jZXNzKHF1ZXJ5OiBzdHJpbmcpe1xyXG4gIGNvbnN0IHN0ZXBzOiBhbnlbXT1bXTsgY29uc3QgcUE9bmV3IFF1ZXJ5QWdlbnQoKTsgY29uc3QgcT1hd2FpdCBxQS5wcm9jZXNzKHtxdWVyeX0pOyBzdGVwcy5wdXNoKC4uLnEudGhpbmtpbmdTdGVwcylcclxuICBsZXQgZG9jdW1lbnRzOiBhbnlbXT1bXVxyXG4gIGlmKHEubmVlZHNSZXRyaWV2YWwpeyBjb25zdCByPW5ldyBSZXRyaWV2YWxBZ2VudCgpOyBjb25zdCBycj1hd2FpdCByLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksazo3fSk7IHN0ZXBzLnB1c2goLi4ucnIudGhpbmtpbmdTdGVwcyk7IGRvY3VtZW50cz1yci5kb2N1bWVudHMgfVxyXG4gIGNvbnN0IGE9bmV3IEFuc3dlckFnZW50KCk7IGNvbnN0IGFyPWF3YWl0IGEucHJvY2Vzcyh7cXVlcnk6cS5wcm9jZXNzZWRRdWVyeSxkb2N1bWVudHN9KTsgc3RlcHMucHVzaCguLi5hci50aGlua2luZ1N0ZXBzKTsgbGV0IGN1cnJlbnQ9YXIuYW5zd2VyXHJcbiAgbGV0IGl0ZXI9MDsgd2hpbGUoaXRlcjwzKXsgY29uc3QgYz1uZXcgQ3JpdGljQWdlbnQoKTsgY29uc3QgY3I9YXdhaXQgYy5wcm9jZXNzKHtxdWVyeTpxLnByb2Nlc3NlZFF1ZXJ5LGFuc3dlcjpjdXJyZW50LGRvY3VtZW50c30pOyBzdGVwcy5wdXNoKC4uLmNyLnRoaW5raW5nU3RlcHMpOyBpZihjci5zY29yZT49OCkgYnJlYWs7IGNvbnN0IHJlZj1uZXcgUmVmaW5lQWdlbnQoKTsgY29uc3QgcmY9YXdhaXQgcmVmLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksYW5zd2VyOmN1cnJlbnQsY3JpdGlxdWU6Y3IuY3JpdGlxdWUsZG9jdW1lbnRzfSk7IHN0ZXBzLnB1c2goLi4ucmYudGhpbmtpbmdTdGVwcyk7IGN1cnJlbnQ9cmYucmVmaW5lZEFuc3dlcjsgaXRlcisrIH1cclxuICByZXR1cm4geyBhbnN3ZXI6IGN1cnJlbnQsIHRoaW5raW5nU3RlcHM6IHN0ZXBzLCBwaXBlbGluZUluZm86IHRoaXMubmFtZSwgc291cmNlczogZG9jdW1lbnRzIH1cclxufX1cclxuXHJcbmNsYXNzIEF1dG9QaXBlbGluZSBleHRlbmRzIEJhc2VQaXBlbGluZSB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ0FVVE86IEFJIFNlbGVjdHMgT3B0aW1hbCcpfSBhc3luYyBwcm9jZXNzKHF1ZXJ5OiBzdHJpbmcpe1xyXG4gIGNvbnN0IHN0ZXBzOmFueT1bXTsgY29uc3QgY29tcGxleGl0eT1xdWVyeS5sZW5ndGg8MzA/ICdzaW1wbGUnIDogcXVlcnkubGVuZ3RoPjEwMD8gJ2NvbXBsZXgnIDogJ21lZGl1bSdcclxuICBsZXQgc2VsZWN0ZWQ6IEJhc2VQaXBlbGluZSA9IGNvbXBsZXhpdHk9PT0nc2ltcGxlJz8gbmV3IFBoYXNlMVBpcGVsaW5lKCkgOiBjb21wbGV4aXR5PT09J21lZGl1bSc/IG5ldyBQaGFzZTJQaXBlbGluZSgpIDogbmV3IFBoYXNlM1BpcGVsaW5lKClcclxuICBjb25zdCByZXM9YXdhaXQgc2VsZWN0ZWQucHJvY2VzcyhxdWVyeSk7IHN0ZXBzLnB1c2goLi4uKHJlcy50aGlua2luZ1N0ZXBzfHxbXSkpXHJcbiAgcmV0dXJuIHsgYW5zd2VyOiByZXMuYW5zd2VyLCB0aGlua2luZ1N0ZXBzOiBzdGVwcywgcGlwZWxpbmVJbmZvOiBgJHt0aGlzLm5hbWV9IOKGkiAke3NlbGVjdGVkLm5hbWV9YCwgc291cmNlczogcmVzLnNvdXJjZXN8fFtdIH1cclxufX1cclxuXHJcbmNsYXNzIFF1aXpQaXBlbGluZSBleHRlbmRzIEJhc2VQaXBlbGluZSB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ1F1aXogR2VuZXJhdGlvbiBQaXBlbGluZScpfSBhc3luYyBwcm9jZXNzKHF1ZXJ5OnN0cmluZywgb3B0aW9uczphbnk9e30peyBjb25zdCBzdGVwczphbnk9W107IGNvbnN0IHFhPW5ldyBRdWVyeUFnZW50KCk7IGNvbnN0IHE9YXdhaXQgcWEucHJvY2Vzcyh7cXVlcnl9KTsgc3RlcHMucHVzaCguLi5xLnRoaW5raW5nU3RlcHMpOyBjb25zdCByPW5ldyBSZXRyaWV2YWxBZ2VudCgpOyBjb25zdCBycj1hd2FpdCByLnByb2Nlc3Moe3F1ZXJ5OnEucHJvY2Vzc2VkUXVlcnksazpvcHRpb25zLmRvY3VtZW50Q291bnR8fDEwfSk7IHN0ZXBzLnB1c2goLi4ucnIudGhpbmtpbmdTdGVwcyk7IGNvbnN0IHF1aXo9bmV3IFF1aXpBZ2VudCgpOyBjb25zdCBxcj1hd2FpdCBxdWl6LnByb2Nlc3MoeyB0b3BpYzogb3B0aW9ucy50b3BpY3x8cS5wcm9jZXNzZWRRdWVyeSwgZG9jdW1lbnRzOiByci5kb2N1bWVudHMsIGRpZmZpY3VsdHk6IG9wdGlvbnMuZGlmZmljdWx0eXx8J21lZGl1bScsIHF1ZXN0aW9uQ291bnQ6IG9wdGlvbnMucXVlc3Rpb25Db3VudHx8NSB9KTsgc3RlcHMucHVzaCguLi5xci50aGlua2luZ1N0ZXBzKTsgcmV0dXJuIHsgcXVlc3Rpb25zOiBxci5xdWVzdGlvbnMsIHRoaW5raW5nU3RlcHM6IHN0ZXBzLCBwaXBlbGluZUluZm86IHRoaXMubmFtZSwgc291cmNlczogcnIuZG9jdW1lbnRzLCBtZXRhZGF0YTogeyB0b3BpYzogb3B0aW9ucy50b3BpY3x8cS5wcm9jZXNzZWRRdWVyeSwgZGlmZmljdWx0eTogb3B0aW9ucy5kaWZmaWN1bHR5fHwnbWVkaXVtJywgcXVlc3Rpb25Db3VudDogcXIucXVlc3Rpb25zLmxlbmd0aCB9IH0gfX1cclxuY2xhc3MgVHV0b3JQaXBlbGluZSBleHRlbmRzIEJhc2VQaXBlbGluZSB7IGNvbnN0cnVjdG9yKCl7c3VwZXIoJ1R1dG9yaW5nIFBpcGVsaW5lJyl9IGFzeW5jIHByb2Nlc3MocXVlcnk6c3RyaW5nLCBvcHRpb25zOmFueT17fSl7IGNvbnN0IHN0ZXBzOmFueT1bXTsgY29uc3QgcWE9bmV3IFF1ZXJ5QWdlbnQoKTsgY29uc3QgcT1hd2FpdCBxYS5wcm9jZXNzKHtxdWVyeX0pOyBzdGVwcy5wdXNoKC4uLnEudGhpbmtpbmdTdGVwcyk7IGNvbnN0IHI9bmV3IFJldHJpZXZhbEFnZW50KCk7IGNvbnN0IHJyPWF3YWl0IHIucHJvY2Vzcyh7cXVlcnk6cS5wcm9jZXNzZWRRdWVyeSxrOm9wdGlvbnMuZG9jdW1lbnRDb3VudHx8OH0pOyBzdGVwcy5wdXNoKC4uLnJyLnRoaW5raW5nU3RlcHMpOyBjb25zdCB0dXRvcj1uZXcgVHV0b3JBZ2VudCgpOyBjb25zdCB0cj1hd2FpdCB0dXRvci5wcm9jZXNzKHsgdG9waWM6IG9wdGlvbnMudG9waWN8fHEucHJvY2Vzc2VkUXVlcnksIGRvY3VtZW50czogcnIuZG9jdW1lbnRzLCB1c2VyTGV2ZWw6IG9wdGlvbnMudXNlckxldmVsfHwnaW50ZXJtZWRpYXRlJywgbGVhcm5pbmdTdHlsZTogb3B0aW9ucy5sZWFybmluZ1N0eWxlfHwncmVhZGluZycgfSk7IHN0ZXBzLnB1c2goLi4udHIudGhpbmtpbmdTdGVwcyk7IHJldHVybiB7IHR1dG9yaWFsU2VjdGlvbnM6IHRyLnR1dG9yaWFsU2VjdGlvbnMsIHRoaW5raW5nU3RlcHM6IHN0ZXBzLCBwaXBlbGluZUluZm86IHRoaXMubmFtZSwgc291cmNlczogcnIuZG9jdW1lbnRzLCBtZXRhZGF0YTogeyB0b3BpYzogb3B0aW9ucy50b3BpY3x8cS5wcm9jZXNzZWRRdWVyeSwgdXNlckxldmVsOiBvcHRpb25zLnVzZXJMZXZlbHx8J2ludGVybWVkaWF0ZScsIHNlY3Rpb25Db3VudDogdHIudHV0b3JpYWxTZWN0aW9ucy5sZW5ndGggfSB9IH19XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGlwZWxpbmUobW9kZTogc3RyaW5nKTogQmFzZVBpcGVsaW5lIHsgc3dpdGNoKG1vZGUpeyBjYXNlICdwaGFzZTEnOiByZXR1cm4gbmV3IFBoYXNlMVBpcGVsaW5lKCk7IGNhc2UgJ3BoYXNlMic6IHJldHVybiBuZXcgUGhhc2UyUGlwZWxpbmUoKTsgY2FzZSAncGhhc2UzJzogcmV0dXJuIG5ldyBQaGFzZTNQaXBlbGluZSgpOyBjYXNlICdhdXRvJzogcmV0dXJuIG5ldyBBdXRvUGlwZWxpbmUoKTsgY2FzZSAnbWV0YSc6IHJldHVybiBuZXcgQXV0b1BpcGVsaW5lKCk7IGNhc2UgJ3F1aXonOiByZXR1cm4gbmV3IFF1aXpQaXBlbGluZSgpOyBjYXNlICd0dXRvcic6IHJldHVybiBuZXcgVHV0b3JQaXBlbGluZSgpOyBkZWZhdWx0OiByZXR1cm4gbmV3IEF1dG9QaXBlbGluZSgpOyB9IH1cclxuIl0sIm5hbWVzIjpbIlF1ZXJ5QWdlbnQiLCJSZXRyaWV2YWxBZ2VudCIsIkFuc3dlckFnZW50IiwiQ3JpdGljQWdlbnQiLCJSZWZpbmVBZ2VudCIsIlF1aXpBZ2VudCIsIlR1dG9yQWdlbnQiLCJCYXNlUGlwZWxpbmUiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJwcm9jZXNzIiwiX3F1ZXJ5IiwiX29wdGlvbnMiLCJFcnJvciIsIlBoYXNlMVBpcGVsaW5lIiwicXVlcnkiLCJzdGVwcyIsInF1ZXJ5QWdlbnQiLCJxIiwicHVzaCIsInRoaW5raW5nU3RlcHMiLCJkb2N1bWVudHMiLCJuZWVkc1JldHJpZXZhbCIsInIiLCJyciIsInByb2Nlc3NlZFF1ZXJ5IiwiayIsImEiLCJhciIsImFuc3dlciIsInBpcGVsaW5lSW5mbyIsInNvdXJjZXMiLCJQaGFzZTJQaXBlbGluZSIsInFBZ2VudCIsImMiLCJjciIsInNjb3JlIiwicmVmIiwicmYiLCJjcml0aXF1ZSIsInJlZmluZWRBbnN3ZXIiLCJQaGFzZTNQaXBlbGluZSIsInFBIiwiY3VycmVudCIsIml0ZXIiLCJBdXRvUGlwZWxpbmUiLCJjb21wbGV4aXR5IiwibGVuZ3RoIiwic2VsZWN0ZWQiLCJyZXMiLCJRdWl6UGlwZWxpbmUiLCJvcHRpb25zIiwicWEiLCJkb2N1bWVudENvdW50IiwicXVpeiIsInFyIiwidG9waWMiLCJkaWZmaWN1bHR5IiwicXVlc3Rpb25Db3VudCIsInF1ZXN0aW9ucyIsIm1ldGFkYXRhIiwiVHV0b3JQaXBlbGluZSIsInR1dG9yIiwidHIiLCJ1c2VyTGV2ZWwiLCJsZWFybmluZ1N0eWxlIiwidHV0b3JpYWxTZWN0aW9ucyIsInNlY3Rpb25Db3VudCIsImNyZWF0ZVBpcGVsaW5lIiwibW9kZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/pipelines.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/vectorstore.ts":
/*!***********************************!*\
  !*** ./src/server/vectorstore.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   QdrantVectorStore: () => (/* binding */ QdrantVectorStore),\n/* harmony export */   VectorStore: () => (/* binding */ VectorStore),\n/* harmony export */   getEmbedding: () => (/* binding */ getEmbedding),\n/* harmony export */   getVectorStore: () => (/* binding */ getVectorStore),\n/* harmony export */   loadSampleDocuments: () => (/* binding */ loadSampleDocuments)\n/* harmony export */ });\n/* harmony import */ var _qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @qdrant/js-client-rest */ \"(rsc)/./node_modules/@qdrant/js-client-rest/dist/esm/qdrant-client.js\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n\n\nconst VECTOR_STORE_TYPE = process.env.VECTOR_STORE || \"qdrant\";\nconst QDRANT_HOST = process.env.QDRANT_HOST || \"localhost\";\nconst QDRANT_PORT = parseInt(process.env.QDRANT_PORT || \"6333\");\nconst QDRANT_CLOUD_URL = process.env.QDRANT_CLOUD_URL;\nconst QDRANT_CLOUD_API_KEY = process.env.QDRANT_CLOUD_API_KEY;\n// Note: The collection name has a leading space in Qdrant Cloud\nconst COLLECTION_NAME = \" pulmo_fishman_v5_google-001\";\nconst GOOGLE_API_KEY = process.env.GOOGLE_API_KEY;\n// Use gemini-embedding-001 with 3072-dim\nconst EMBEDDING_MODEL = process.env.EMBEDDING_MODEL || \"gemini-embedding-001\";\nconst EMBEDDING_DIM = parseInt(process.env.EMBEDDING_DIM || \"3072\");\nasync function getEmbedding(text) {\n    if (!GOOGLE_API_KEY) throw new Error(\"Google API key not found for embeddings\");\n    const genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(GOOGLE_API_KEY);\n    // Use gemini-embedding-001 with outputDimensionality set to 3072\n    try {\n        const model = genAI.getGenerativeModel({\n            model: EMBEDDING_MODEL\n        });\n        console.log(`Generating embedding with model: ${EMBEDDING_MODEL} for text length: ${text.length}, requesting ${EMBEDDING_DIM} dimensions`);\n        const result = await model.embedContent(text, {\n            outputDimensionality: EMBEDDING_DIM\n        });\n        const values = result.embedding.values;\n        console.log(`Embedding generated: ${values.length} dimensions`);\n        if (values.length !== EMBEDDING_DIM) {\n            console.warn(`Embedding dimension ${values.length} != configured ${EMBEDDING_DIM}. Requested ${EMBEDDING_DIM} but got ${values.length}.`);\n        }\n        return values;\n    } catch (e) {\n        console.error(\"Embedding with outputDimensionality failed:\", e);\n        // Try without outputDimensionality as fallback\n        try {\n            console.log(\"Retrying without outputDimensionality parameter...\");\n            const model = genAI.getGenerativeModel({\n                model: EMBEDDING_MODEL\n            });\n            const result = await model.embedContent(text);\n            const values = result.embedding.values;\n            console.log(`Fallback embedding generated: ${values.length} dimensions`);\n            return values;\n        } catch (e2) {\n            console.error(\"Fallback embedding also failed:\", e2);\n            throw new Error(`Embedding generation failed: ${e2?.message || e2}`);\n        }\n    }\n}\nclass VectorStore {\n    async init() {}\n    async addDocuments(_documents) {}\n    async similaritySearch(_query, _k) {\n        return [];\n    }\n    async deleteCollection() {}\n    async getCollectionInfo() {\n        return {};\n    }\n    async countDocuments() {\n        return 0;\n    }\n}\nclass QdrantVectorStore extends VectorStore {\n    constructor(){\n        super();\n        if (QDRANT_CLOUD_URL && QDRANT_CLOUD_API_KEY && QDRANT_CLOUD_URL.startsWith(\"http\")) {\n            this.client = new _qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_1__.QdrantClient({\n                url: QDRANT_CLOUD_URL,\n                apiKey: QDRANT_CLOUD_API_KEY\n            });\n        } else {\n            this.client = new _qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_1__.QdrantClient({\n                host: QDRANT_HOST,\n                port: QDRANT_PORT\n            });\n        }\n        this.collectionName = COLLECTION_NAME;\n    }\n    async init() {\n        try {\n            const collections = await this.client.getCollections();\n            console.log(`[QdrantVectorStore] Available collections:`, collections.collections.map((c)=>c.name));\n            const exists = collections.collections.find((c)=>c.name === this.collectionName);\n            if (!exists) {\n                console.warn(`[QdrantVectorStore] Collection \"${this.collectionName}\" not found in Qdrant!`);\n                console.warn(`[QdrantVectorStore] Available collections are:`, collections.collections.map((c)=>c.name).join(\", \"));\n            // Do NOT create a new collection - use the existing one\n            // await this.client.createCollection(this.collectionName, { vectors: { size: EMBEDDING_DIM, distance: 'Cosine' } })\n            } else {\n                const info = await this.client.getCollection(this.collectionName);\n                console.log(`[QdrantVectorStore] Using existing collection \"${this.collectionName}\" with ${info.points_count} points, vector size: ${info.config?.params?.vectors?.size || \"unknown\"}`);\n            }\n        } catch (error) {\n            console.error(`[QdrantVectorStore] Error during init:`, error.message || error);\n        }\n    }\n    async addDocuments(documents) {\n        const embeddings = await Promise.all(documents.map((d)=>getEmbedding(d.content)));\n        const points = documents.map((doc, i)=>({\n                id: Date.now() + i,\n                vector: embeddings[i],\n                payload: {\n                    content: doc.content,\n                    ...doc.metadata\n                }\n            }));\n        await this.client.upsert(this.collectionName, {\n            wait: true,\n            points\n        });\n    }\n    extractContent(payload) {\n        if (!payload) return \"\";\n        const candidates = [\n            \"content\",\n            \"text\",\n            \"page_content\",\n            \"chunk\",\n            \"document\",\n            \"body\",\n            \"data\",\n            \"summary\"\n        ];\n        for (const key of candidates){\n            const v = payload[key] ?? payload?.payload?.[key];\n            if (typeof v === \"string\" && v.trim().length > 0) return v;\n            if (Array.isArray(v)) {\n                const joined = v.filter(Boolean).join(\" \").trim();\n                if (joined) return joined;\n            }\n            if (v && typeof v === \"object\") {\n                const str = JSON.stringify(v);\n                if (str && str.length > 0) return str;\n            }\n        }\n        // If payload has a single string field, use it\n        const values = Object.values(payload);\n        const firstStr = values.find((v)=>typeof v === \"string\");\n        if (firstStr) return firstStr;\n        return \"\";\n    }\n    extractSource(payload) {\n        return payload?.source || payload?.url || payload?.link || payload?.metadata?.source || payload?.file || undefined;\n    }\n    async similaritySearch(query, k) {\n        console.log(`[QdrantVectorStore] Searching in collection: \"${this.collectionName}\" for query: \"${query}\" with k=${k}`);\n        const vector = await getEmbedding(query);\n        console.log(`[QdrantVectorStore] Vector generated, searching with ${vector.length} dimensions...`);\n        try {\n            const results = await this.client.search(this.collectionName, {\n                vector,\n                limit: k,\n                with_payload: true\n            });\n            console.log(`[QdrantVectorStore] Search completed, found ${results.length} results`);\n            return results.map((r)=>{\n                const content = this.extractContent(r.payload);\n                const meta = {\n                    ...r.payload\n                };\n                if (!meta.source) {\n                    const src = this.extractSource(r.payload);\n                    if (src) meta.source = src;\n                }\n                return {\n                    content,\n                    metadata: meta,\n                    distance: r.score\n                };\n            });\n        } catch (error) {\n            console.error(`[QdrantVectorStore] Search failed:`, error.response?.data || error.message || error);\n            throw error;\n        }\n    }\n    async deleteCollection() {\n        await this.client.deleteCollection(this.collectionName);\n    }\n    async getCollectionInfo() {\n        return this.client.getCollection(this.collectionName);\n    }\n    async countDocuments() {\n        const info = await this.getCollectionInfo();\n        return info?.points_count || 0;\n    }\n}\nlet vectorStoreInstance = null;\nasync function getVectorStore() {\n    if (!vectorStoreInstance) {\n        vectorStoreInstance = VECTOR_STORE_TYPE === \"qdrant\" ? new QdrantVectorStore() : new VectorStore();\n        await vectorStoreInstance.init();\n    }\n    return vectorStoreInstance;\n}\nasync function loadSampleDocuments() {\n    const vectorStore = await getVectorStore();\n    const sampleDocuments = [\n        {\n            content: \"Artificial Intelligence (AI) ...\",\n            metadata: {\n                source: \"AI Basics\",\n                category: \"technology\",\n                type: \"definition\"\n            }\n        },\n        {\n            content: \"Machine Learning is a subset ...\",\n            metadata: {\n                source: \"ML Fundamentals\",\n                category: \"machine-learning\",\n                type: \"definition\"\n            }\n        },\n        {\n            content: \"RAG (Retrieval-Augmented Generation) ...\",\n            metadata: {\n                source: \"RAG Architecture\",\n                category: \"ai-architecture\",\n                type: \"explanation\"\n            }\n        }\n    ];\n    await vectorStore.addDocuments(sampleDocuments);\n    return {\n        success: true,\n        message: `Successfully loaded ${sampleDocuments.length} sample documents`,\n        documentCount: sampleDocuments.length\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VyxJQUFJMEMsc0JBQXNCLElBQUlWO1FBQ3JGLE1BQU1vRixvQkFBb0JuRixJQUFJO0lBQ2hDO0lBQ0EsT0FBT21GO0FBQ1Q7QUFFTyxlQUFlRTtJQUNwQixNQUFNQyxjQUFjLE1BQU1GO0lBQzFCLE1BQU1HLGtCQUFrQjtRQUN0QjtZQUFFakQsU0FBUztZQUFvQ1MsVUFBVTtnQkFBRW1CLFFBQVE7Z0JBQWFzQixVQUFVO2dCQUFjQyxNQUFNO1lBQWE7UUFBRTtRQUM3SDtZQUFFbkQsU0FBUztZQUFvQ1MsVUFBVTtnQkFBRW1CLFFBQVE7Z0JBQW1Cc0IsVUFBVTtnQkFBb0JDLE1BQU07WUFBYTtRQUFFO1FBQ3pJO1lBQUVuRCxTQUFTO1lBQTRDUyxVQUFVO2dCQUFFbUIsUUFBUTtnQkFBb0JzQixVQUFVO2dCQUFtQkMsTUFBTTtZQUFjO1FBQUU7S0FDbko7SUFDRCxNQUFNSCxZQUFZckYsWUFBWSxDQUFDc0Y7SUFDL0IsT0FBTztRQUFFRyxTQUFTO1FBQU01RixTQUFTLENBQUMsb0JBQW9CLEVBQUV5RixnQkFBZ0JuRyxNQUFNLENBQUMsaUJBQWlCLENBQUM7UUFBRXVHLGVBQWVKLGdCQUFnQm5HLE1BQU07SUFBQztBQUMzSSIsInNvdXJjZXMiOlsid2VicGFjazovL3NtYXJ0LXNhZ2UtYm90Ly4vc3JjL3NlcnZlci92ZWN0b3JzdG9yZS50cz8wZGM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFFkcmFudENsaWVudCB9IGZyb20gJ0BxZHJhbnQvanMtY2xpZW50LXJlc3QnXHJcbmltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gJ0Bnb29nbGUvZ2VuZXJhdGl2ZS1haSdcclxuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi9lbnZpcm9ubWVudCdcclxuXHJcbmNvbnN0IFZFQ1RPUl9TVE9SRV9UWVBFID0gcHJvY2Vzcy5lbnYuVkVDVE9SX1NUT1JFIHx8ICdxZHJhbnQnXHJcbmNvbnN0IFFEUkFOVF9IT1NUID0gcHJvY2Vzcy5lbnYuUURSQU5UX0hPU1QgfHwgJ2xvY2FsaG9zdCdcclxuY29uc3QgUURSQU5UX1BPUlQgPSBwYXJzZUludChwcm9jZXNzLmVudi5RRFJBTlRfUE9SVCB8fCAnNjMzMycpXHJcbmNvbnN0IFFEUkFOVF9DTE9VRF9VUkwgPSBwcm9jZXNzLmVudi5RRFJBTlRfQ0xPVURfVVJMXHJcbmNvbnN0IFFEUkFOVF9DTE9VRF9BUElfS0VZID0gcHJvY2Vzcy5lbnYuUURSQU5UX0NMT1VEX0FQSV9LRVlcclxuLy8gTm90ZTogVGhlIGNvbGxlY3Rpb24gbmFtZSBoYXMgYSBsZWFkaW5nIHNwYWNlIGluIFFkcmFudCBDbG91ZFxyXG5jb25zdCBDT0xMRUNUSU9OX05BTUUgPSAnIHB1bG1vX2Zpc2htYW5fdjVfZ29vZ2xlLTAwMSdcclxuY29uc3QgR09PR0xFX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5HT09HTEVfQVBJX0tFWVxyXG4vLyBVc2UgZ2VtaW5pLWVtYmVkZGluZy0wMDEgd2l0aCAzMDcyLWRpbVxyXG5jb25zdCBFTUJFRERJTkdfTU9ERUwgPSBwcm9jZXNzLmVudi5FTUJFRERJTkdfTU9ERUwgfHwgJ2dlbWluaS1lbWJlZGRpbmctMDAxJ1xyXG5jb25zdCBFTUJFRERJTkdfRElNID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuRU1CRURESU5HX0RJTSB8fCAnMzA3MicpXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RW1iZWRkaW5nKHRleHQ6IHN0cmluZykge1xyXG4gIGlmICghR09PR0xFX0FQSV9LRVkpIHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGZvdW5kIGZvciBlbWJlZGRpbmdzJylcclxuICBjb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkoR09PR0xFX0FQSV9LRVkpXHJcblxyXG4gIC8vIFVzZSBnZW1pbmktZW1iZWRkaW5nLTAwMSB3aXRoIG91dHB1dERpbWVuc2lvbmFsaXR5IHNldCB0byAzMDcyXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IG1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IEVNQkVERElOR19NT0RFTCB9KVxyXG4gICAgY29uc29sZS5sb2coYEdlbmVyYXRpbmcgZW1iZWRkaW5nIHdpdGggbW9kZWw6ICR7RU1CRURESU5HX01PREVMfSBmb3IgdGV4dCBsZW5ndGg6ICR7dGV4dC5sZW5ndGh9LCByZXF1ZXN0aW5nICR7RU1CRURESU5HX0RJTX0gZGltZW5zaW9uc2ApXHJcbiAgICBcclxuICAgIGNvbnN0IHJlc3VsdDogYW55ID0gYXdhaXQgKG1vZGVsIGFzIGFueSkuZW1iZWRDb250ZW50KHRleHQsIHtcclxuICAgICAgb3V0cHV0RGltZW5zaW9uYWxpdHk6IEVNQkVERElOR19ESU1cclxuICAgIH0pXHJcbiAgICBcclxuICAgIGNvbnN0IHZhbHVlcyA9IHJlc3VsdC5lbWJlZGRpbmcudmFsdWVzXHJcbiAgICBjb25zb2xlLmxvZyhgRW1iZWRkaW5nIGdlbmVyYXRlZDogJHt2YWx1ZXMubGVuZ3RofSBkaW1lbnNpb25zYClcclxuICAgIFxyXG4gICAgaWYgKHZhbHVlcy5sZW5ndGggIT09IEVNQkVERElOR19ESU0pIHtcclxuICAgICAgY29uc29sZS53YXJuKGBFbWJlZGRpbmcgZGltZW5zaW9uICR7dmFsdWVzLmxlbmd0aH0gIT0gY29uZmlndXJlZCAke0VNQkVERElOR19ESU19LiBSZXF1ZXN0ZWQgJHtFTUJFRERJTkdfRElNfSBidXQgZ290ICR7dmFsdWVzLmxlbmd0aH0uYClcclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZXNcclxuICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0VtYmVkZGluZyB3aXRoIG91dHB1dERpbWVuc2lvbmFsaXR5IGZhaWxlZDonLCBlKVxyXG4gICAgLy8gVHJ5IHdpdGhvdXQgb3V0cHV0RGltZW5zaW9uYWxpdHkgYXMgZmFsbGJhY2tcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdSZXRyeWluZyB3aXRob3V0IG91dHB1dERpbWVuc2lvbmFsaXR5IHBhcmFtZXRlci4uLicpXHJcbiAgICAgIGNvbnN0IG1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IEVNQkVERElOR19NT0RFTCB9KVxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2RlbC5lbWJlZENvbnRlbnQodGV4dClcclxuICAgICAgY29uc3QgdmFsdWVzID0gcmVzdWx0LmVtYmVkZGluZy52YWx1ZXNcclxuICAgICAgY29uc29sZS5sb2coYEZhbGxiYWNrIGVtYmVkZGluZyBnZW5lcmF0ZWQ6ICR7dmFsdWVzLmxlbmd0aH0gZGltZW5zaW9uc2ApXHJcbiAgICAgIHJldHVybiB2YWx1ZXNcclxuICAgIH0gY2F0Y2ggKGUyOiBhbnkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFsbGJhY2sgZW1iZWRkaW5nIGFsc28gZmFpbGVkOicsIGUyKVxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVtYmVkZGluZyBnZW5lcmF0aW9uIGZhaWxlZDogJHtlMj8ubWVzc2FnZSB8fCBlMn1gKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSZXRyaWV2ZWREb2MgeyBjb250ZW50OiBzdHJpbmc7IG1ldGFkYXRhOiBhbnk7IGRpc3RhbmNlOiBudW1iZXIgfVxyXG5cclxuZXhwb3J0IGNsYXNzIFZlY3RvclN0b3JlIHtcclxuICBhc3luYyBpbml0KCkge31cclxuICBhc3luYyBhZGREb2N1bWVudHMoX2RvY3VtZW50czogQXJyYXk8eyBjb250ZW50OiBzdHJpbmc7IG1ldGFkYXRhPzogYW55IH0+KSB7fVxyXG4gIGFzeW5jIHNpbWlsYXJpdHlTZWFyY2goX3F1ZXJ5OiBzdHJpbmcsIF9rOiBudW1iZXIpOiBQcm9taXNlPFJldHJpZXZlZERvY1tdPiB7IHJldHVybiBbXSB9XHJcbiAgYXN5bmMgZGVsZXRlQ29sbGVjdGlvbigpIHt9XHJcbiAgYXN5bmMgZ2V0Q29sbGVjdGlvbkluZm8oKTogUHJvbWlzZTxhbnk+IHsgcmV0dXJuIHt9IH1cclxuICBhc3luYyBjb3VudERvY3VtZW50cygpOiBQcm9taXNlPG51bWJlcj4geyByZXR1cm4gMCB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBRZHJhbnRWZWN0b3JTdG9yZSBleHRlbmRzIFZlY3RvclN0b3JlIHtcclxuICBjbGllbnQ6IFFkcmFudENsaWVudFxyXG4gIGNvbGxlY3Rpb25OYW1lOiBzdHJpbmdcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKClcclxuICAgIGlmIChRRFJBTlRfQ0xPVURfVVJMICYmIFFEUkFOVF9DTE9VRF9BUElfS0VZICYmIFFEUkFOVF9DTE9VRF9VUkwuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XHJcbiAgICAgIHRoaXMuY2xpZW50ID0gbmV3IFFkcmFudENsaWVudCh7IHVybDogUURSQU5UX0NMT1VEX1VSTCwgYXBpS2V5OiBRRFJBTlRfQ0xPVURfQVBJX0tFWSB9KVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jbGllbnQgPSBuZXcgUWRyYW50Q2xpZW50KHsgaG9zdDogUURSQU5UX0hPU1QsIHBvcnQ6IFFEUkFOVF9QT1JUIH0pXHJcbiAgICB9XHJcbiAgICB0aGlzLmNvbGxlY3Rpb25OYW1lID0gQ09MTEVDVElPTl9OQU1FXHJcbiAgfVxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb2xsZWN0aW9ucyA9IGF3YWl0IHRoaXMuY2xpZW50LmdldENvbGxlY3Rpb25zKClcclxuICAgICAgY29uc29sZS5sb2coYFtRZHJhbnRWZWN0b3JTdG9yZV0gQXZhaWxhYmxlIGNvbGxlY3Rpb25zOmAsIGNvbGxlY3Rpb25zLmNvbGxlY3Rpb25zLm1hcChjID0+IGMubmFtZSkpXHJcbiAgICAgIGNvbnN0IGV4aXN0cyA9IGNvbGxlY3Rpb25zLmNvbGxlY3Rpb25zLmZpbmQoYyA9PiBjLm5hbWUgPT09IHRoaXMuY29sbGVjdGlvbk5hbWUpXHJcbiAgICAgIGlmICghZXhpc3RzKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBbUWRyYW50VmVjdG9yU3RvcmVdIENvbGxlY3Rpb24gXCIke3RoaXMuY29sbGVjdGlvbk5hbWV9XCIgbm90IGZvdW5kIGluIFFkcmFudCFgKVxyXG4gICAgICAgIGNvbnNvbGUud2FybihgW1FkcmFudFZlY3RvclN0b3JlXSBBdmFpbGFibGUgY29sbGVjdGlvbnMgYXJlOmAsIGNvbGxlY3Rpb25zLmNvbGxlY3Rpb25zLm1hcChjID0+IGMubmFtZSkuam9pbignLCAnKSlcclxuICAgICAgICAvLyBEbyBOT1QgY3JlYXRlIGEgbmV3IGNvbGxlY3Rpb24gLSB1c2UgdGhlIGV4aXN0aW5nIG9uZVxyXG4gICAgICAgIC8vIGF3YWl0IHRoaXMuY2xpZW50LmNyZWF0ZUNvbGxlY3Rpb24odGhpcy5jb2xsZWN0aW9uTmFtZSwgeyB2ZWN0b3JzOiB7IHNpemU6IEVNQkVERElOR19ESU0sIGRpc3RhbmNlOiAnQ29zaW5lJyB9IH0pXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IHRoaXMuY2xpZW50LmdldENvbGxlY3Rpb24odGhpcy5jb2xsZWN0aW9uTmFtZSlcclxuICAgICAgICBjb25zb2xlLmxvZyhgW1FkcmFudFZlY3RvclN0b3JlXSBVc2luZyBleGlzdGluZyBjb2xsZWN0aW9uIFwiJHt0aGlzLmNvbGxlY3Rpb25OYW1lfVwiIHdpdGggJHtpbmZvLnBvaW50c19jb3VudH0gcG9pbnRzLCB2ZWN0b3Igc2l6ZTogJHtpbmZvLmNvbmZpZz8ucGFyYW1zPy52ZWN0b3JzPy5zaXplIHx8ICd1bmtub3duJ31gKVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtRZHJhbnRWZWN0b3JTdG9yZV0gRXJyb3IgZHVyaW5nIGluaXQ6YCwgZXJyb3IubWVzc2FnZSB8fCBlcnJvcilcclxuICAgIH1cclxuICB9XHJcbiAgYXN5bmMgYWRkRG9jdW1lbnRzKGRvY3VtZW50czogQXJyYXk8eyBjb250ZW50OiBzdHJpbmc7IG1ldGFkYXRhPzogYW55IH0+KSB7XHJcbiAgICBjb25zdCBlbWJlZGRpbmdzID0gYXdhaXQgUHJvbWlzZS5hbGwoZG9jdW1lbnRzLm1hcChkID0+IGdldEVtYmVkZGluZyhkLmNvbnRlbnQpKSlcclxuICAgIGNvbnN0IHBvaW50cyA9IGRvY3VtZW50cy5tYXAoKGRvYywgaSkgPT4gKHtcclxuICAgICAgaWQ6IERhdGUubm93KCkgKyBpLFxyXG4gICAgICB2ZWN0b3I6IGVtYmVkZGluZ3NbaV0sXHJcbiAgICAgIHBheWxvYWQ6IHsgY29udGVudDogZG9jLmNvbnRlbnQsIC4uLmRvYy5tZXRhZGF0YSB9LFxyXG4gICAgfSkpXHJcbiAgICBhd2FpdCB0aGlzLmNsaWVudC51cHNlcnQodGhpcy5jb2xsZWN0aW9uTmFtZSwgeyB3YWl0OiB0cnVlLCBwb2ludHMgfSlcclxuICB9XHJcbiAgcHJpdmF0ZSBleHRyYWN0Q29udGVudChwYXlsb2FkOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKCFwYXlsb2FkKSByZXR1cm4gJydcclxuICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBbXHJcbiAgICAgICdjb250ZW50JywgJ3RleHQnLCAncGFnZV9jb250ZW50JywgJ2NodW5rJywgJ2RvY3VtZW50JywgJ2JvZHknLCAnZGF0YScsICdzdW1tYXJ5J1xyXG4gICAgXVxyXG4gICAgZm9yIChjb25zdCBrZXkgb2YgY2FuZGlkYXRlcykge1xyXG4gICAgICBjb25zdCB2ID0gcGF5bG9hZFtrZXldID8/IHBheWxvYWQ/LnBheWxvYWQ/LltrZXldXHJcbiAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ3N0cmluZycgJiYgdi50cmltKCkubGVuZ3RoID4gMCkgcmV0dXJuIHZcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodikpIHtcclxuICAgICAgICBjb25zdCBqb2luZWQgPSB2LmZpbHRlcihCb29sZWFuKS5qb2luKCcgJykudHJpbSgpXHJcbiAgICAgICAgaWYgKGpvaW5lZCkgcmV0dXJuIGpvaW5lZFxyXG4gICAgICB9XHJcbiAgICAgIGlmICh2ICYmIHR5cGVvZiB2ID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KHYpXHJcbiAgICAgICAgaWYgKHN0ciAmJiBzdHIubGVuZ3RoID4gMCkgcmV0dXJuIHN0clxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBJZiBwYXlsb2FkIGhhcyBhIHNpbmdsZSBzdHJpbmcgZmllbGQsIHVzZSBpdFxyXG4gICAgY29uc3QgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyhwYXlsb2FkKVxyXG4gICAgY29uc3QgZmlyc3RTdHIgPSB2YWx1ZXMuZmluZCh2ID0+IHR5cGVvZiB2ID09PSAnc3RyaW5nJykgYXMgc3RyaW5nIHwgdW5kZWZpbmVkXHJcbiAgICBpZiAoZmlyc3RTdHIpIHJldHVybiBmaXJzdFN0clxyXG4gICAgcmV0dXJuICcnXHJcbiAgfVxyXG4gIHByaXZhdGUgZXh0cmFjdFNvdXJjZShwYXlsb2FkOiBhbnkpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgcGF5bG9hZD8uc291cmNlIHx8IHBheWxvYWQ/LnVybCB8fCBwYXlsb2FkPy5saW5rIHx8IHBheWxvYWQ/Lm1ldGFkYXRhPy5zb3VyY2UgfHwgcGF5bG9hZD8uZmlsZSB8fCB1bmRlZmluZWRcclxuICAgIClcclxuICB9XHJcbiAgYXN5bmMgc2ltaWxhcml0eVNlYXJjaChxdWVyeTogc3RyaW5nLCBrOiBudW1iZXIpOiBQcm9taXNlPFJldHJpZXZlZERvY1tdPiB7XHJcbiAgICBjb25zb2xlLmxvZyhgW1FkcmFudFZlY3RvclN0b3JlXSBTZWFyY2hpbmcgaW4gY29sbGVjdGlvbjogXCIke3RoaXMuY29sbGVjdGlvbk5hbWV9XCIgZm9yIHF1ZXJ5OiBcIiR7cXVlcnl9XCIgd2l0aCBrPSR7a31gKTtcclxuICAgIGNvbnN0IHZlY3RvciA9IGF3YWl0IGdldEVtYmVkZGluZyhxdWVyeSlcclxuICAgIGNvbnNvbGUubG9nKGBbUWRyYW50VmVjdG9yU3RvcmVdIFZlY3RvciBnZW5lcmF0ZWQsIHNlYXJjaGluZyB3aXRoICR7dmVjdG9yLmxlbmd0aH0gZGltZW5zaW9ucy4uLmApO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzdWx0czogYW55ID0gYXdhaXQgdGhpcy5jbGllbnQuc2VhcmNoKHRoaXMuY29sbGVjdGlvbk5hbWUsIHsgdmVjdG9yLCBsaW1pdDogaywgd2l0aF9wYXlsb2FkOiB0cnVlIH0pXHJcbiAgICAgIGNvbnNvbGUubG9nKGBbUWRyYW50VmVjdG9yU3RvcmVdIFNlYXJjaCBjb21wbGV0ZWQsIGZvdW5kICR7cmVzdWx0cy5sZW5ndGh9IHJlc3VsdHNgKTtcclxuICAgICAgcmV0dXJuIHJlc3VsdHMubWFwKChyOiBhbnkpID0+IHtcclxuICAgICAgICBjb25zdCBjb250ZW50ID0gdGhpcy5leHRyYWN0Q29udGVudChyLnBheWxvYWQpXHJcbiAgICAgICAgY29uc3QgbWV0YSA9IHsgLi4uci5wYXlsb2FkIH1cclxuICAgICAgICBpZiAoIW1ldGEuc291cmNlKSB7XHJcbiAgICAgICAgICBjb25zdCBzcmMgPSB0aGlzLmV4dHJhY3RTb3VyY2Uoci5wYXlsb2FkKVxyXG4gICAgICAgICAgaWYgKHNyYykgKG1ldGEgYXMgYW55KS5zb3VyY2UgPSBzcmNcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHsgY29udGVudCwgbWV0YWRhdGE6IG1ldGEsIGRpc3RhbmNlOiByLnNjb3JlIH1cclxuICAgICAgfSlcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW1FkcmFudFZlY3RvclN0b3JlXSBTZWFyY2ggZmFpbGVkOmAsIGVycm9yLnJlc3BvbnNlPy5kYXRhIHx8IGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcbiAgYXN5bmMgZGVsZXRlQ29sbGVjdGlvbigpIHsgYXdhaXQgdGhpcy5jbGllbnQuZGVsZXRlQ29sbGVjdGlvbih0aGlzLmNvbGxlY3Rpb25OYW1lKSB9XHJcbiAgYXN5bmMgZ2V0Q29sbGVjdGlvbkluZm8oKSB7IHJldHVybiB0aGlzLmNsaWVudC5nZXRDb2xsZWN0aW9uKHRoaXMuY29sbGVjdGlvbk5hbWUpIH1cclxuICBhc3luYyBjb3VudERvY3VtZW50cygpIHsgY29uc3QgaW5mbzogYW55ID0gYXdhaXQgdGhpcy5nZXRDb2xsZWN0aW9uSW5mbygpOyByZXR1cm4gaW5mbz8ucG9pbnRzX2NvdW50IHx8IDAgfVxyXG59XHJcblxyXG5sZXQgdmVjdG9yU3RvcmVJbnN0YW5jZTogVmVjdG9yU3RvcmUgfCBudWxsID0gbnVsbFxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VmVjdG9yU3RvcmUoKTogUHJvbWlzZTxWZWN0b3JTdG9yZT4ge1xyXG4gIGlmICghdmVjdG9yU3RvcmVJbnN0YW5jZSkge1xyXG4gICAgdmVjdG9yU3RvcmVJbnN0YW5jZSA9IFZFQ1RPUl9TVE9SRV9UWVBFID09PSAncWRyYW50JyA/IG5ldyBRZHJhbnRWZWN0b3JTdG9yZSgpIDogbmV3IFZlY3RvclN0b3JlKClcclxuICAgIGF3YWl0IHZlY3RvclN0b3JlSW5zdGFuY2UuaW5pdCgpXHJcbiAgfVxyXG4gIHJldHVybiB2ZWN0b3JTdG9yZUluc3RhbmNlXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkU2FtcGxlRG9jdW1lbnRzKCkge1xyXG4gIGNvbnN0IHZlY3RvclN0b3JlID0gYXdhaXQgZ2V0VmVjdG9yU3RvcmUoKVxyXG4gIGNvbnN0IHNhbXBsZURvY3VtZW50cyA9IFtcclxuICAgIHsgY29udGVudDogJ0FydGlmaWNpYWwgSW50ZWxsaWdlbmNlIChBSSkgLi4uJywgbWV0YWRhdGE6IHsgc291cmNlOiAnQUkgQmFzaWNzJywgY2F0ZWdvcnk6ICd0ZWNobm9sb2d5JywgdHlwZTogJ2RlZmluaXRpb24nIH0gfSxcclxuICAgIHsgY29udGVudDogJ01hY2hpbmUgTGVhcm5pbmcgaXMgYSBzdWJzZXQgLi4uJywgbWV0YWRhdGE6IHsgc291cmNlOiAnTUwgRnVuZGFtZW50YWxzJywgY2F0ZWdvcnk6ICdtYWNoaW5lLWxlYXJuaW5nJywgdHlwZTogJ2RlZmluaXRpb24nIH0gfSxcclxuICAgIHsgY29udGVudDogJ1JBRyAoUmV0cmlldmFsLUF1Z21lbnRlZCBHZW5lcmF0aW9uKSAuLi4nLCBtZXRhZGF0YTogeyBzb3VyY2U6ICdSQUcgQXJjaGl0ZWN0dXJlJywgY2F0ZWdvcnk6ICdhaS1hcmNoaXRlY3R1cmUnLCB0eXBlOiAnZXhwbGFuYXRpb24nIH0gfSxcclxuICBdXHJcbiAgYXdhaXQgdmVjdG9yU3RvcmUuYWRkRG9jdW1lbnRzKHNhbXBsZURvY3VtZW50cylcclxuICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiBgU3VjY2Vzc2Z1bGx5IGxvYWRlZCAke3NhbXBsZURvY3VtZW50cy5sZW5ndGh9IHNhbXBsZSBkb2N1bWVudHNgLCBkb2N1bWVudENvdW50OiBzYW1wbGVEb2N1bWVudHMubGVuZ3RoIH1cclxufVxyXG4iXSwibmFtZXMiOlsiUWRyYW50Q2xpZW50IiwiR29vZ2xlR2VuZXJhdGl2ZUFJIiwiVkVDVE9SX1NUT1JFX1RZUEUiLCJwcm9jZXNzIiwiZW52IiwiVkVDVE9SX1NUT1JFIiwiUURSQU5UX0hPU1QiLCJRRFJBTlRfUE9SVCIsInBhcnNlSW50IiwiUURSQU5UX0NMT1VEX1VSTCIsIlFEUkFOVF9DTE9VRF9BUElfS0VZIiwiQ09MTEVDVElPTl9OQU1FIiwiR09PR0xFX0FQSV9LRVkiLCJFTUJFRERJTkdfTU9ERUwiLCJFTUJFRERJTkdfRElNIiwiZ2V0RW1iZWRkaW5nIiwidGV4dCIsIkVycm9yIiwiZ2VuQUkiLCJtb2RlbCIsImdldEdlbmVyYXRpdmVNb2RlbCIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJyZXN1bHQiLCJlbWJlZENvbnRlbnQiLCJvdXRwdXREaW1lbnNpb25hbGl0eSIsInZhbHVlcyIsImVtYmVkZGluZyIsIndhcm4iLCJlIiwiZXJyb3IiLCJlMiIsIm1lc3NhZ2UiLCJWZWN0b3JTdG9yZSIsImluaXQiLCJhZGREb2N1bWVudHMiLCJfZG9jdW1lbnRzIiwic2ltaWxhcml0eVNlYXJjaCIsIl9xdWVyeSIsIl9rIiwiZGVsZXRlQ29sbGVjdGlvbiIsImdldENvbGxlY3Rpb25JbmZvIiwiY291bnREb2N1bWVudHMiLCJRZHJhbnRWZWN0b3JTdG9yZSIsImNvbnN0cnVjdG9yIiwic3RhcnRzV2l0aCIsImNsaWVudCIsInVybCIsImFwaUtleSIsImhvc3QiLCJwb3J0IiwiY29sbGVjdGlvbk5hbWUiLCJjb2xsZWN0aW9ucyIsImdldENvbGxlY3Rpb25zIiwibWFwIiwiYyIsIm5hbWUiLCJleGlzdHMiLCJmaW5kIiwiam9pbiIsImluZm8iLCJnZXRDb2xsZWN0aW9uIiwicG9pbnRzX2NvdW50IiwiY29uZmlnIiwicGFyYW1zIiwidmVjdG9ycyIsInNpemUiLCJkb2N1bWVudHMiLCJlbWJlZGRpbmdzIiwiUHJvbWlzZSIsImFsbCIsImQiLCJjb250ZW50IiwicG9pbnRzIiwiZG9jIiwiaSIsImlkIiwiRGF0ZSIsIm5vdyIsInZlY3RvciIsInBheWxvYWQiLCJtZXRhZGF0YSIsInVwc2VydCIsIndhaXQiLCJleHRyYWN0Q29udGVudCIsImNhbmRpZGF0ZXMiLCJrZXkiLCJ2IiwidHJpbSIsIkFycmF5IiwiaXNBcnJheSIsImpvaW5lZCIsImZpbHRlciIsIkJvb2xlYW4iLCJzdHIiLCJKU09OIiwic3RyaW5naWZ5IiwiT2JqZWN0IiwiZmlyc3RTdHIiLCJleHRyYWN0U291cmNlIiwic291cmNlIiwibGluayIsImZpbGUiLCJ1bmRlZmluZWQiLCJxdWVyeSIsImsiLCJyZXN1bHRzIiwic2VhcmNoIiwibGltaXQiLCJ3aXRoX3BheWxvYWQiLCJyIiwibWV0YSIsInNyYyIsImRpc3RhbmNlIiwic2NvcmUiLCJyZXNwb25zZSIsImRhdGEiLCJ2ZWN0b3JTdG9yZUluc3RhbmNlIiwiZ2V0VmVjdG9yU3RvcmUiLCJsb2FkU2FtcGxlRG9jdW1lbnRzIiwidmVjdG9yU3RvcmUiLCJzYW1wbGVEb2N1bWVudHMiLCJjYXRlZ29yeSIsInR5cGUiLCJzdWNjZXNzIiwiZG9jdW1lbnRDb3VudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/vectorstore.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/undici","vendor-chunks/axios","vendor-chunks/@qdrant","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/@google","vendor-chunks/supports-color","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream","vendor-chunks/@sevinf"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftutor%2Fexplain%2Froute&page=%2Fapi%2Ftutor%2Fexplain%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftutor%2Fexplain%2Froute.ts&appDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CCode%20projects%5Cgithub%20projects%5Csmart-sage-bot&isDev=true&tsconfigPath=.%2Ftsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();